<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/docs.advanced.way/blog/rss.xml" title="è¿›é˜¶ä¹‹è·¯ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs.advanced.way/blog/atom.xml" title="è¿›é˜¶ä¹‹è·¯ Blog Atom Feed"><title data-react-helmet="true">å¤šçº¿ç¨‹ | è¿›é˜¶ä¹‹è·¯</title><meta data-react-helmet="true" property="og:url" content="https://Goldwood1024.github.io/docs.advanced.way/docs/java/hc/å¤šçº¿ç¨‹"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="å¤šçº¿ç¨‹ | è¿›é˜¶ä¹‹è·¯"><meta data-react-helmet="true" name="description" content="çº¿ç¨‹"><meta data-react-helmet="true" property="og:description" content="çº¿ç¨‹"><link data-react-helmet="true" rel="shortcut icon" href="/docs.advanced.way/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://Goldwood1024.github.io/docs.advanced.way/docs/java/hc/å¤šçº¿ç¨‹"><link data-react-helmet="true" rel="alternate" href="https://Goldwood1024.github.io/docs.advanced.way/docs/java/hc/å¤šçº¿ç¨‹" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://Goldwood1024.github.io/docs.advanced.way/docs/java/hc/å¤šçº¿ç¨‹" hreflang="x-default"><link rel="stylesheet" href="/docs.advanced.way/assets/css/styles.1814d5b2.css">
<link rel="preload" href="/docs.advanced.way/assets/js/styles.d2979f79.js" as="script">
<link rel="preload" href="/docs.advanced.way/assets/js/runtime~main.c79be437.js" as="script">
<link rel="preload" href="/docs.advanced.way/assets/js/main.a0c081f8.js" as="script">
<link rel="preload" href="/docs.advanced.way/assets/js/1.68ccfdd8.js" as="script">
<link rel="preload" href="/docs.advanced.way/assets/js/2.0ae89a79.js" as="script">
<link rel="preload" href="/docs.advanced.way/assets/js/3.ef70b8bc.js" as="script">
<link rel="preload" href="/docs.advanced.way/assets/js/1be78505.8900d4c5.js" as="script">
<link rel="preload" href="/docs.advanced.way/assets/js/202.499d5c45.js" as="script">
<link rel="preload" href="/docs.advanced.way/assets/js/935f2afb.410f6dda.js" as="script">
<link rel="preload" href="/docs.advanced.way/assets/js/17896441.a99ce0cd.js" as="script">
<link rel="preload" href="/docs.advanced.way/assets/js/e7ff1b1e.2e6811a0.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs.advanced.way/"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">è¿›é˜¶ä¹‹è·¯</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.advanced.way/docs/java/">Java</a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link">å¸¸ç”¨æ¡†æ¶</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs.advanced.way/docs/framework/spring/">å¸¸ç”¨æ¡†æ¶</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/framework/mybatis/">Mybatis</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/framework/auth/auth">æƒé™ç®¡ç†</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link">ä¸­é—´ä»¶</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs.advanced.way/docs/distributed/">åˆ†å¸ƒå¼</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/tranctional/">äº‹åŠ¡</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/mq/">æ¶ˆæ¯é˜Ÿåˆ—</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link">äº‘åŸç”Ÿ</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs.advanced.way/docs/cloud/docker/base/é•œåƒ/">Dockerå®¹å™¨</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/k8s/">K8s</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link">æœåŠ¡å™¨</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs.advanced.way/docs/linux/">Linux</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/cache/">ç¼“å­˜</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/db/mysql/InnoDB/">æ•°æ®åº“</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/cs/network/tcpip/">è®¡ç®—æœºç³»ç»Ÿ</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link">ç¼–ç å®è·µ</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs.advanced.way/docs/algorithm/algorithm/">ç®—æ³•/æ•°æ®ç»“æ„</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/patterns/">è®¾è®¡æ¨¡å¼</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/architecture/">æ¶æ„è®¾è®¡</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/job/java/">é¢è¯•</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/memo/tool/sublime/">å¤‡å¿˜</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link">å°ç™¾ç§‘</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs.advanced.way/docs/cyclopedia/chinese/notes/dingding/">è¯¾å ‚ç¬”è®°</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/cyclopedia/chinese/lan/idiom/">å¤§ä¸­å›½</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs.advanced.way/blog">åšå®¢</a><a href="https://github.com/Goldwood1024/docs.advanced.way.git" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/docs.advanced.way/"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">è¿›é˜¶ä¹‹è·¯</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs.advanced.way/docs/java/">Java</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">å¸¸ç”¨æ¡†æ¶</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/framework/spring/">å¸¸ç”¨æ¡†æ¶</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/framework/mybatis/">Mybatis</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/framework/auth/auth">æƒé™ç®¡ç†</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">ä¸­é—´ä»¶</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/distributed/">åˆ†å¸ƒå¼</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/tranctional/">äº‹åŠ¡</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/mq/">æ¶ˆæ¯é˜Ÿåˆ—</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">äº‘åŸç”Ÿ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/cloud/docker/base/é•œåƒ/">Dockerå®¹å™¨</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/k8s/">K8s</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">æœåŠ¡å™¨</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/linux/">Linux</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/cache/">ç¼“å­˜</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/db/mysql/InnoDB/">æ•°æ®åº“</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/cs/network/tcpip/">è®¡ç®—æœºç³»ç»Ÿ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">ç¼–ç å®è·µ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/algorithm/algorithm/">ç®—æ³•/æ•°æ®ç»“æ„</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/patterns/">è®¾è®¡æ¨¡å¼</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/architecture/">æ¶æ„è®¾è®¡</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/job/java/">é¢è¯•</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/memo/tool/sublime/">å¤‡å¿˜</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">å°ç™¾ç§‘</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/cyclopedia/chinese/notes/dingding/">è¯¾å ‚ç¬”è®°</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/cyclopedia/chinese/lan/idiom/">å¤§ä¸­å›½</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/blog">åšå®¢</a></li><li class="menu__list-item"><a href="https://github.com/Goldwood1024/docs.advanced.way.git" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/docs.advanced.way/"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--dark_hz6m"><strong>è¿›é˜¶ä¹‹è·¯</strong></a><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">åŸºç¡€</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/">ç®€ä»‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/object">é¢å‘å¯¹è±¡</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/å…³é”®å­—">å…³é”®å­—</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/String">String</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/io">I/O</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/nio">NIO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/Reference">å¯¹è±¡å¼•ç”¨</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/ä»£ç†">ä»£ç†</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/å‡½æ•°å¼æ¥å£">å‡½æ•°å¼æ¥å£</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/åå°„">åå°„</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/base64">Base64ç¼–ç </a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/jdk">JDK</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">é›†åˆ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/collection/Collection">Collection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/collection/List">List</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/collection/Map">Map</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">é«˜å¹¶å‘</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs.advanced.way/docs/java/hc/é«˜å¹¶å‘">é«˜å¹¶å‘</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs.advanced.way/docs/java/hc/å¤šçº¿ç¨‹">å¤šçº¿ç¨‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs.advanced.way/docs/java/hc/å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯">å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs.advanced.way/docs/java/hc/å†…å­˜æ¨¡å‹">å†…å­˜æ¨¡å‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs.advanced.way/docs/java/hc/åŸå­ç±»">åŸå­ç±»</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs.advanced.way/docs/java/hc/å¹¶å‘å®¹å™¨">å¹¶å‘å®¹å™¨</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs.advanced.way/docs/java/hc/å¹¶å‘å·¥å…·ç±»">å¹¶å‘å·¥å…·ç±»</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs.advanced.way/docs/java/hc/çº¿ç¨‹æ± ">çº¿ç¨‹æ± </a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs.advanced.way/docs/java/hc/é”">é”</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">JVM</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/å¯¹è±¡åˆ›å»ºè¿‡ç¨‹">å¯¹è±¡åˆ›å»ºè¿‡ç¨‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/å¯¹è±¡å›æ”¶æœºåˆ¶">å¯¹è±¡å›æ”¶æœºåˆ¶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/jvmå‚æ•°">JVMå‚æ•°</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/jvmå†…å­˜æ¨¡å‹">å†…å­˜æ¨¡å‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/å†…å­˜ä¼˜åŒ–">å†…å­˜ä¼˜åŒ–</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/åƒåœ¾æ”¶é›†å™¨">åƒåœ¾æ”¶é›†å™¨</a></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" role="img" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">å¤šçº¿ç¨‹</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹"></a>çº¿ç¨‹<a class="hash-link" href="#çº¿ç¨‹" title="Direct link to heading">#</a></h2><p>ç°ä»£æ“ä½œç³»ç»Ÿåœ¨è¿è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªè¿›ç¨‹ã€‚æ“ä½œç³»ç»Ÿè°ƒåº¦æœ€å°çš„å•å…ƒæ˜¯çº¿ç¨‹ã€‚
ä¸€ä¸ªè¿›ç¨‹å†…å¯ä»¥åˆ›å»ºå¤šä¸ªçº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹åˆæœ‰å„è‡ªçš„è®¡æ•°å™¨ï¼Œå †æ ˆå’Œå±€éƒ¨å˜é‡</p><p>ä¼˜ç‚¹:</p><ul><li>æ›´å¤šçš„å¤„ç†å™¨æ ¸å¿ƒ</li><li>æ›´å¿«çš„å“åº”æ—¶é—´</li><li>æ›´å¥½çš„ç¼–ç¨‹æ¨¡å‹</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="å¹¶å‘å’Œå¹¶è¡Œ"></a>å¹¶å‘å’Œå¹¶è¡Œ<a class="hash-link" href="#å¹¶å‘å’Œå¹¶è¡Œ" title="Direct link to heading">#</a></h3><p>å¤šçº¿ç¨‹æ˜¯å¤šä»»åŠ¡çš„ä¸€ç§ç‰¹åˆ«çš„å½¢å¼ï¼Œä½†å¤šçº¿ç¨‹ä½¿ç”¨äº†æ›´å°çš„èµ„æºå¼€é”€</p><ul><li>å¹¶è¡Œæ˜¯æŒ‡åŒä¸€æ—¶åˆ»ï¼Œå¤šä¸ªå‘½ä»¤åœ¨å¤šä¸ªå¤„ç†å™¨ä¸ŠåŒæ—¶æ‰§è¡Œï¼›</li><li>å¹¶å‘æ˜¯æŒ‡åœ¨åŒä¸€æ—¶åˆ»ï¼Œåªæœ‰ä¸€æ¡å‘½ä»¤æ˜¯åœ¨å¤„ç†å™¨ä¸Šæ‰§è¡Œçš„ï¼Œä½†å¤šä¸ªè¿›ç¨‹å‘½ä»¤è¢«å¿«é€Ÿè½®æ¢æ‰§è¡Œï¼Œä½¿å¾—åœ¨å®è§‚ä¸Šå…·æœ‰å¤šä¸ªè¿›ç¨‹åŒæ—¶æ‰§è¡Œçš„æ•ˆæœ</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹çŠ¶æ€"></a>çº¿ç¨‹çŠ¶æ€<a class="hash-link" href="#çº¿ç¨‹çŠ¶æ€" title="Direct link to heading">#</a></h3><p><img src="/docs.advanced.way/assets/images/1689841-af3e5b75b44e972c-466ad979fe759b0ca16be0b465eda842.png"></p><p><img src="/docs.advanced.way/assets/images/1689841-383f7101e6588094-eeb862b5be48478843f674863e74339d.png"></p><ol><li><p>æ–°å»ºçŠ¶æ€:<br>
ä½¿ç”¨ new å…³é”®å­—å’Œ Thread ç±»æˆ–å…¶å­ç±»å»ºç«‹ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡åï¼Œè¯¥çº¿ç¨‹å¯¹è±¡å°±å¤„äºæ–°å»ºçŠ¶æ€ã€‚å®ƒä¿æŒè¿™ä¸ªçŠ¶æ€ç›´åˆ°ç¨‹åº start() è¿™ä¸ªçº¿ç¨‹ã€‚</p></li><li><p>å°±ç»ªçŠ¶æ€:<br>
å½“çº¿ç¨‹å¯¹è±¡è°ƒç”¨äº†start()æ–¹æ³•ä¹‹åï¼Œè¯¥çº¿ç¨‹å°±è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚å°±ç»ªçŠ¶æ€çš„çº¿ç¨‹å¤„äºå°±ç»ªé˜Ÿåˆ—ä¸­ï¼Œè¦ç­‰å¾…JVMé‡Œçº¿ç¨‹è°ƒåº¦å™¨çš„è°ƒåº¦ã€‚  </p><blockquote><p>æ¯ä¸ªé”å¯¹è±¡éƒ½æœ‰ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯å°±ç»ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯é˜»å¡é˜Ÿåˆ—ï¼Œå°±ç»ªé˜Ÿåˆ—å­˜å‚¨äº†å°†è¦è·å¾—é”çš„çº¿ç¨‹ï¼Œé˜»å¡é˜Ÿåˆ—å­˜å‚¨äº†è¢«é˜»å¡çš„çº¿ç¨‹ï¼Œå½“ä¸€ä¸ªè¢«çº¿ç¨‹è¢«å”¤é†’ (notify)åï¼Œæ‰ä¼šè¿›å…¥åˆ°å°±ç»ªé˜Ÿåˆ—ï¼Œç­‰å¾…è·å¾—é”  </p></blockquote></li><li><p>è¿è¡ŒçŠ¶æ€:<br>
å¦‚æœå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è·å– CPU èµ„æºï¼Œå°±å¯ä»¥æ‰§è¡Œ run()ï¼Œæ­¤æ—¶çº¿ç¨‹ä¾¿å¤„äºè¿è¡ŒçŠ¶æ€ã€‚å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹æœ€ä¸ºå¤æ‚ï¼Œå®ƒå¯ä»¥å˜ä¸ºé˜»å¡çŠ¶æ€ã€å°±ç»ªçŠ¶æ€å’Œæ­»äº¡çŠ¶æ€ã€‚</p></li><li><p>é˜»å¡çŠ¶æ€:<br>
å¦‚æœä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œäº†sleepï¼ˆç¡çœ ï¼‰ã€suspendï¼ˆæŒ‚èµ·ï¼‰ç­‰æ–¹æ³•ï¼Œå¤±å»æ‰€å ç”¨èµ„æºä¹‹åï¼Œè¯¥çº¿ç¨‹å°±ä»è¿è¡ŒçŠ¶æ€è¿›å…¥é˜»å¡çŠ¶æ€ã€‚åœ¨ç¡çœ æ—¶é—´å·²åˆ°æˆ–è·å¾—è®¾å¤‡èµ„æºåå¯ä»¥é‡æ–°è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚<br>
å¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š
ç­‰å¾…é˜»å¡ï¼šè¿è¡ŒçŠ¶æ€ä¸­çš„çº¿ç¨‹æ‰§è¡Œ wait() æ–¹æ³•ï¼Œä½¿çº¿ç¨‹è¿›å…¥åˆ°ç­‰å¾…é˜»å¡çŠ¶æ€ã€‚<br>
åŒæ­¥é˜»å¡ï¼šçº¿ç¨‹åœ¨è·å– synchronized åŒæ­¥é”å¤±è´¥(å› ä¸ºåŒæ­¥é”è¢«å…¶ä»–çº¿ç¨‹å ç”¨)ã€‚<br>
å…¶ä»–é˜»å¡ï¼šé€šè¿‡è°ƒç”¨çº¿ç¨‹çš„ sleep() æˆ– join() å‘å‡ºäº† I/O è¯·æ±‚æ—¶ï¼Œçº¿ç¨‹å°±ä¼šè¿›å…¥åˆ°é˜»å¡çŠ¶æ€ã€‚å½“sleep() çŠ¶æ€è¶…æ—¶ï¼Œjoin() ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è¶…æ—¶ï¼Œæˆ–è€… I/O å¤„ç†å®Œæ¯•ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å°±ç»ªçŠ¶æ€ã€‚  </p></li></ol><ul><li>è°ƒç”¨join()å’Œsleep()æ–¹æ³•ï¼Œsleep()æ—¶é—´ç»“æŸæˆ–è¢«æ‰“æ–­ï¼Œjoin()ä¸­æ–­,IOå®Œæˆéƒ½ä¼šå›åˆ°RunnableçŠ¶æ€ï¼Œç­‰å¾…JVMçš„è°ƒåº¦ã€‚</li><li>è°ƒç”¨wait()ï¼Œä½¿è¯¥çº¿ç¨‹å¤„äºç­‰å¾…æ± (wait blocked pool),ç›´åˆ°notify()/notifyAll()ï¼Œçº¿ç¨‹è¢«å”¤é†’è¢«æ”¾åˆ°é”å®šæ± (lock blocked pool )ï¼Œé‡Šæ”¾åŒæ­¥é”ä½¿çº¿ç¨‹å›åˆ°å¯è¿è¡ŒçŠ¶æ€ï¼ˆRunnableï¼‰</li><li>å¯¹RunningçŠ¶æ€çš„çº¿ç¨‹åŠ åŒæ­¥é”(Synchronized)ä½¿å…¶è¿›å…¥(lock blocked pool ),åŒæ­¥é”è¢«é‡Šæ”¾è¿›å…¥å¯è¿è¡ŒçŠ¶æ€(Runnable)ã€‚</li></ul><ol start="5"><li>æ­»äº¡çŠ¶æ€:
ä¸€ä¸ªè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹å®Œæˆä»»åŠ¡æˆ–è€…å…¶ä»–ç»ˆæ­¢æ¡ä»¶å‘ç”Ÿæ—¶ï¼Œè¯¥çº¿ç¨‹å°±åˆ‡æ¢åˆ°ç»ˆæ­¢çŠ¶æ€ã€‚  </li></ol><blockquote><p>start()çš„å«ä¹‰: å½“å‰çº¿ç¨‹åŒæ­¥å‘ŠçŸ¥è™šæ‹Ÿæœºï¼Œåªè¦çº¿ç¨‹è§„åˆ’å™¨ç©ºé—²ï¼Œåº”ç«‹å³å¯åŠ¨è°ƒç”¨start()æ–¹æ³•çš„çº¿ç¨‹
join()çš„å«ä¹‰: å½“å‰çº¿ç¨‹ç­‰å¾…threadçº¿ç¨‹ç»ˆæ­¢ä¹‹åæ‰ä»thread.join()è¿”å›</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="åˆ›å»ºçº¿ç¨‹"></a>åˆ›å»ºçº¿ç¨‹<a class="hash-link" href="#åˆ›å»ºçº¿ç¨‹" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="åˆ›å»º"></a>åˆ›å»º<a class="hash-link" href="#åˆ›å»º" title="Direct link to heading">#</a></h4><ol><li>ç»§æ‰¿Threadç±»</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">class Thread1 extends Thread {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    @Override</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public void run() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        // to do</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol start="2"><li>å®ç° Runnable</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">class class2 implements Runnable{</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    @Override</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public void run() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol start="3"><li>å®ç° Callable</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">class class3 implements Callable&lt;String&gt; {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    @Override</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public String call() throws Exception {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        return null;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="åŸç†"></a>åŸç†<a class="hash-link" href="#åŸç†" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">// æ¥å—æ³›å‹å‚æ•°</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@FunctionalInterface</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public interface Callable&lt;V&gt; {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    V call() throws Exception;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">@FunctionalInterface</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public interface Runnable {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public abstract void run();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">// å®ç° Runnable</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public class Thread implements Runnable {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Runnableæ²¡æœ‰è¿”å›å€¼ï¼›Callableå¯ä»¥è¿”å›æ‰§è¡Œç»“æœï¼Œæ˜¯ä¸ªæ³›å‹ï¼Œå’ŒFutureã€FutureTaské…åˆå¯ä»¥ç”¨æ¥è·å–å¼‚æ­¥æ‰§è¡Œçš„ç»“æœ</p><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="future"></a>Future<a class="hash-link" href="#future" title="Direct link to heading">#</a></h5><p>Futureå°±æ˜¯å¯¹äºå…·ä½“çš„Runnableæˆ–è€…Callableä»»åŠ¡çš„æ‰§è¡Œç»“æœè¿›è¡Œå–æ¶ˆã€æŸ¥è¯¢æ˜¯å¦å®Œæˆã€è·å–ç»“æœã€‚
å¿…è¦æ—¶å¯ä»¥é€šè¿‡getæ–¹æ³•è·å–æ‰§è¡Œç»“æœï¼Œè¯¥æ–¹æ³•ä¼šé˜»å¡ç›´åˆ°ä»»åŠ¡è¿”å›ç»“æœ</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public interface Future&lt;V&gt; {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // ç”¨æ¥å–æ¶ˆä»»åŠ¡ï¼Œå¦‚æœå–æ¶ˆä»»åŠ¡æˆåŠŸåˆ™è¿”å›trueï¼Œå¦‚æœå–æ¶ˆä»»åŠ¡å¤±è´¥åˆ™è¿”å›false</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    boolean cancel(boolean mayInterruptIfRunning);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¢«å–æ¶ˆæˆåŠŸ</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    boolean isCancelled();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆ</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    boolean isDone();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // ç”¨æ¥è·å–æ‰§è¡Œç»“æœï¼Œè¿™ä¸ªæ–¹æ³•ä¼šäº§ç”Ÿé˜»å¡ï¼Œä¼šä¸€ç›´ç­‰åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ‰è¿”å›</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    V get() throws InterruptedException, ExecutionException;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // ç”¨æ¥è·å–æ‰§è¡Œç»“æœï¼Œå¦‚æœåœ¨æŒ‡å®šæ—¶é—´å†…ï¼Œè¿˜æ²¡è·å–åˆ°ç»“æœï¼Œå°±ç›´æ¥è¿”å›null</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    V get(long timeout, TimeUnit unit) throws InterruptedException, ExecutionException, TimeoutException;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="runnablefutureclass"></a>RunnableFuture.class<a class="hash-link" href="#runnablefutureclass" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public interface RunnableFuture&lt;V&gt; extends Runnable, Future&lt;V&gt; {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    void run();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="futuretaskclass"></a>FutureTask.class<a class="hash-link" href="#futuretaskclass" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public class FutureTask&lt;V&gt; implements RunnableFuture&lt;V&gt; {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private volatile int state;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private static final int NEW          = 0;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private static final int COMPLETING   = 1;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private static final int NORMAL       = 2;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private static final int EXCEPTIONAL  = 3;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private static final int CANCELLED    = 4;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private static final int INTERRUPTING = 5;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private static final int INTERRUPTED  = 6;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    /** The underlying callable; nulled out after running */</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private Callable&lt;V&gt; callable;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    /** The result to return or exception to throw from get() */</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private Object outcome; // non-volatile, protected by state reads/writes</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    /** The thread running the callable; CASed during run() */</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private volatile Thread runner;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    /** Treiber stack of waiting threads */</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private volatile WaitNode waiters;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public FutureTask(Callable&lt;V&gt; callable) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        if (callable == null)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            throw new NullPointerException();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        this.callable = callable;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        this.state = NEW;       // ensure visibility of callable</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public void run() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        if (state != NEW ||</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            !RUNNER.compareAndSet(this, null, Thread.currentThread()))</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            return;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        try {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            Callable&lt;V&gt; c = callable;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            if (c != null &amp;&amp; state == NEW) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                V result;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                boolean ran;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                try {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    // æ‰§è¡Œä»»åŠ¡</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    result = c.call();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    ran = true;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                } catch (Throwable ex) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    result = null;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    ran = false;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    setException(ex);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                if (ran)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    // è®¾ç½®å€¼</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    set(result);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        } finally {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            // runner must be non-null until state is settled to</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            // prevent concurrent calls to run()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            runner = null;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            // state must be re-read after nulling runner to prevent</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            // leaked interrupts</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            int s = state;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            if (s &gt;= INTERRUPTING)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                handlePossibleCancellationInterrupt(s);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    protected void set(V v) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        if (STATE.compareAndSet(this, NEW, COMPLETING)) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            outcome = v;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            STATE.setRelease(this, NORMAL); // final state</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            finishCompletion();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private void finishCompletion() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        // assert state &gt; COMPLETING;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        for (WaitNode q; (q = waiters) != null;) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            if (WAITERS.weakCompareAndSet(this, q, null)) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                for (;;) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    Thread t = q.thread;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    if (t != null) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                        q.thread = null;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                        LockSupport.unpark(t);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    WaitNode next = q.next;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    if (next == null)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                        break;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    q.next = null; // unlink to help gc</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    q = next;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                break;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        done();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        callable = null;        // to reduce footprint</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    protected void done() { }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹ç®¡ç†"></a>çº¿ç¨‹ç®¡ç†<a class="hash-link" href="#çº¿ç¨‹ç®¡ç†" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ç¡çœ "></a>ç¡çœ <a class="hash-link" href="#ç¡çœ " title="Direct link to heading">#</a></h4><p>è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœä¸€æ®µæ—¶é—´ï¼Œå¹¶è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œåˆ™å¯ä»¥é€šè¿‡è°ƒç”¨Threadçš„sleepæ–¹æ³•</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Thread.sleep(1000*1); // ä¼‘çœ 1ç§’</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹è®©æ­¥yield"></a>çº¿ç¨‹è®©æ­¥â€”â€”yield<a class="hash-link" href="#çº¿ç¨‹è®©æ­¥yield" title="Direct link to heading">#</a></h4><p>yield()æ–¹æ³•åªæ˜¯è®©å½“å‰çº¿ç¨‹æš‚åœä¸€ä¸‹ï¼Œé‡æ–°è¿›å…¥å°±ç»ªçš„çº¿ç¨‹æ± ä¸­ï¼Œè®©ç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦å™¨é‡æ–°è°ƒåº¦å™¨é‡æ–°è°ƒåº¦ä¸€æ¬¡ï¼ˆä¸è¿›å…¥é˜»å¡çŠ¶æ€ï¼‰</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹åˆå¹¶"></a>çº¿ç¨‹åˆå¹¶<a class="hash-link" href="#çº¿ç¨‹åˆå¹¶" title="Direct link to heading">#</a></h4><p>çº¿ç¨‹çš„åˆå¹¶çš„å«ä¹‰å°±æ˜¯å°†å‡ ä¸ªå¹¶è¡Œçº¿ç¨‹çš„çº¿ç¨‹åˆå¹¶ä¸ºä¸€ä¸ªå•çº¿ç¨‹æ‰§è¡Œï¼Œåº”ç”¨åœºæ™¯æ˜¯å½“ä¸€ä¸ªçº¿ç¨‹å¿…é¡»ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ‰èƒ½æ‰§è¡Œæ—¶ï¼ŒThreadç±»æä¾›äº†joinæ–¹æ³•æ¥å®Œæˆè¿™ä¸ªåŠŸèƒ½ï¼Œæ³¨æ„ï¼Œå®ƒä¸æ˜¯é™æ€æ–¹æ³•</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹çš„ä¼˜å…ˆçº§"></a>çº¿ç¨‹çš„ä¼˜å…ˆçº§<a class="hash-link" href="#çº¿ç¨‹çš„ä¼˜å…ˆçº§" title="Direct link to heading">#</a></h4><p>æ¯ä¸€ä¸ª Java çº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªä¼˜å…ˆçº§ï¼Œè¿™æ ·æœ‰åŠ©äºæ“ä½œç³»ç»Ÿç¡®å®šçº¿ç¨‹çš„è°ƒåº¦é¡ºåºã€‚<br>
Java çº¿ç¨‹çš„ä¼˜å…ˆçº§æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå…¶å–å€¼èŒƒå›´æ˜¯ 1 ï¼ˆThread.MIN_PRIORITY ï¼‰ - 10 ï¼ˆThread.MAX_PRIORITY ï¼‰ã€‚<br>
é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½ä¼šåˆ†é…ä¸€ä¸ªä¼˜å…ˆçº§ NORM_PRIORITYï¼ˆ5ï¼‰ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹è°ƒåº¦"></a>çº¿ç¨‹è°ƒåº¦<a class="hash-link" href="#çº¿ç¨‹è°ƒåº¦" title="Direct link to heading">#</a></h3><p>çº¿ç¨‹è°ƒåº¦æ˜¯æŒ‡ç³»ç»Ÿä¸ºçº¿ç¨‹åˆ†é…å¤„ç†å™¨ä½¿ç”¨æƒçš„è¿‡ç¨‹ï¼Œä¸»è¦è°ƒåº¦æ–¹å¼åˆ†ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯ååŒå¼çº¿ç¨‹è°ƒåº¦å’ŒæŠ¢å å¼çº¿ç¨‹è°ƒåº¦ã€‚   </p><ul><li>ååŒå¼çº¿ç¨‹è°ƒåº¦<br>çº¿ç¨‹æ‰§è¡Œæ—¶é—´ç”±çº¿ç¨‹æœ¬èº«æ¥æ§åˆ¶ï¼Œçº¿ç¨‹æŠŠè‡ªå·±çš„å·¥ä½œæ‰§è¡Œå®Œä¹‹åï¼Œè¦ä¸»åŠ¨é€šçŸ¥ç³»ç»Ÿåˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸Šã€‚æœ€å¤§å¥½å¤„æ˜¯å®ç°ç®€å•ï¼Œä¸”åˆ‡æ¢æ“ä½œå¯¹çº¿ç¨‹è‡ªå·±æ˜¯å¯çŸ¥çš„ï¼Œæ²¡å•¥çº¿ç¨‹åŒæ­¥é—®é¢˜ã€‚åå¤„æ˜¯çº¿ç¨‹æ‰§è¡Œæ—¶é—´ä¸å¯æ§åˆ¶ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹æœ‰é—®é¢˜ï¼Œå¯èƒ½ä¸€ç›´é˜»å¡åœ¨é‚£é‡Œã€‚ </li><li>æŠ¢å å¼è°ƒåº¦<br>æ¯ä¸ªçº¿ç¨‹å°†ç”±ç³»ç»Ÿæ¥åˆ†é…æ‰§è¡Œæ—¶é—´ï¼Œçº¿ç¨‹çš„åˆ‡æ¢ä¸ç”±çº¿ç¨‹æœ¬èº«æ¥å†³å®šï¼ˆJavaä¸­ï¼ŒThread.yield()å¯ä»¥è®©å‡ºæ‰§è¡Œæ—¶é—´ï¼Œä½†æ— æ³•è·å–æ‰§è¡Œæ—¶é—´ï¼‰ã€‚çº¿ç¨‹æ‰§è¡Œæ—¶é—´ç³»ç»Ÿå¯æ§ï¼Œä¹Ÿä¸ä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹å¯¼è‡´æ•´ä¸ªè¿›ç¨‹é˜»å¡ã€‚  </li></ul><blockquote><p>Javaçº¿ç¨‹è°ƒåº¦å°±æ˜¯æŠ¢å å¼è°ƒåº¦ã€‚ </p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹åŒæ­¥"></a>çº¿ç¨‹åŒæ­¥<a class="hash-link" href="#çº¿ç¨‹åŒæ­¥" title="Direct link to heading">#</a></h3><p> javaå…è®¸å¤šçº¿ç¨‹å¹¶å‘æ§åˆ¶ï¼Œå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯å…±äº«çš„èµ„æºå˜é‡æ—¶ï¼ˆå¦‚æ•°æ®çš„å¢åˆ æ”¹æŸ¥ï¼‰ï¼Œå°†ä¼šå¯¼è‡´æ•°æ®ä¸å‡†ç¡®ï¼Œç›¸äº’ä¹‹é—´äº§ç”Ÿå†²çªï¼Œå› æ­¤åŠ å…¥åŒæ­¥é”ä»¥é¿å…åœ¨è¯¥çº¿ç¨‹æ²¡æœ‰å®Œæˆæ“ä½œä¹‹å‰ï¼Œè¢«å…¶ä»–çº¿ç¨‹çš„è°ƒç”¨ï¼Œä»è€Œä¿è¯äº†è¯¥å˜é‡çš„å”¯ä¸€æ€§å’Œå‡†ç¡®æ€§ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="åŒæ­¥æ–¹æ³•"></a>åŒæ­¥æ–¹æ³•<a class="hash-link" href="#åŒæ­¥æ–¹æ³•" title="Direct link to heading">#</a></h4><blockquote><p>ç”±äºjavaçš„æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå†…ç½®é”ï¼Œå½“ç”¨æ­¤å…³é”®å­—ä¿®é¥°æ–¹æ³•æ—¶ï¼Œå†…ç½®é”ä¼šä¿æŠ¤æ•´ä¸ªæ–¹æ³•ã€‚åœ¨è°ƒç”¨è¯¥æ–¹æ³•å‰ï¼Œéœ€è¦è·å¾—å†…ç½®é”ï¼Œå¦åˆ™å°±å¤„äºé˜»å¡çŠ¶æ€</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">// å¯¹è±¡é”</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public synchronized void fun(){</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // todo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">// ç±»é”</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public synchronized static void fun(){</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // todo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol><li><p>å†…ç½®é”ï¼ˆåˆå« éšå¼é”ï¼‰ï¼šsynchronized æ˜¯å†…ç½®äºJDKä¸­çš„ï¼Œåº•å±‚å®ç°æ˜¯nativeï¼›åŒæ—¶ï¼ŒåŠ é”ã€è§£é”éƒ½æ˜¯JDKè‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·æ˜¾å¼åœ°æ§åˆ¶ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p></li><li><p>åŒæ­¥é”ï¼šsynchronized ç”¨äºåŒæ­¥çº¿ç¨‹ï¼Œä½¿çº¿ç¨‹äº’æ–¥åœ°è®¿é—®æŸæ®µä»£ç å—ã€æ–¹æ³•ã€‚è¿™å°±æ˜¯æ„å‘³ç€æœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè·å¾—è¯¥é”ï¼Œå½“çº¿ç¨‹Aå°è¯•å»è·å¾—çº¿ç¨‹BæŒæœ‰çš„å†…ç½®é”æ—¶ï¼Œçº¿ç¨‹Aå¿…é¡»ç­‰å¾…æˆ–è€…é˜»å¡ï¼ŒçŸ¥é“çº¿ç¨‹Bé‡Šæ”¾è¿™ä¸ªé”ï¼Œå¦‚æœBçº¿ç¨‹ä¸é‡Šæ”¾è¿™ä¸ªé”ï¼Œé‚£ä¹ˆAçº¿ç¨‹å°†æ°¸è¿œç­‰å¾…ä¸‹å»</p></li><li><p>å¯¹è±¡é”ï¼šå‡†ç¡®æ¥è¯´ï¼Œæ˜¯åˆ†ä¸ºå¯¹è±¡é”ã€ç±»é”ã€‚synchronized ä»¥å½“å‰çš„æŸä¸ªå¯¹è±¡ä¸ºé”ï¼Œçº¿ç¨‹å¿…é¡»é€šè¿‡äº’æ–¥ç«äº‰æ‹¿åˆ°è¿™æŠŠå¯¹è±¡é”ï¼Œä»è€Œæ‰èƒ½è®¿é—® ä¸´ç•ŒåŒºçš„ä»£ç ï¼Œè®¿é—®ç»“æŸåï¼Œå°±ä¼šé‡Šæ”¾é”ï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹æ‰æœ‰å¯èƒ½è·å–é”æ¥è®¿é—®ä¸´ç•ŒåŒºï¼ˆè¢«é”ä½çš„ä»£ç åŒºåŸŸï¼‰ã€‚</p><blockquote><p>synchronizedé” æ ¹æ®é”çš„èŒƒå›´åˆ†ä¸º å¯¹è±¡é” å’Œ ç±»é”ã€‚<br>
å¯¹è±¡é”ï¼Œæ˜¯ä»¥å¯¹è±¡å®ä¾‹ä¸ºé”ï¼Œå½“å¤šä¸ªçº¿ç¨‹å…±äº«è®¿é—®è¿™ä¸ªå¯¹è±¡å®ä¾‹ä¸‹çš„ä¸´ç•ŒåŒºï¼Œåªéœ€è¦ç«äº‰è¿™ä¸ªå¯¹è±¡å®ä¾‹ä¾¿å¯ï¼Œä¸åŒå¯¹è±¡å®ä¾‹ä¸‹çš„ä¸´ç•ŒåŒºæ˜¯ä¸ç”¨äº’æ–¥è®¿é—®ï¼›<br>
ç±»é”ï¼Œåˆ™æ˜¯ä»¥ç±»çš„classå¯¹è±¡ä¸ºé”ï¼Œè¿™ä¸ªé”ä¸‹çš„ä¸´ç•ŒåŒºï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å¿…é¡»äº’æ–¥è®¿é—®ï¼Œå°½ç®¡æ˜¯ä½¿ç”¨äº†ä¸åŒçš„å¯¹è±¡å®ä¾‹</p></blockquote><blockquote><p>ä¸´ç•ŒåŒºå°±æ˜¯åœ¨åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªä»»åŠ¡è®¿é—®çš„ä»£ç åŒº</p></blockquote></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="åŒæ­¥ä»£ç å—"></a>åŒæ­¥ä»£ç å—<a class="hash-link" href="#åŒæ­¥ä»£ç å—" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public int fun(){</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    synchronized( object ) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">       //ä»£ç å—ï¼Œä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol><li><p>object æ˜¯ thisï¼Œæ˜¯å¯¹è±¡é”ï¼ŒthisæŒ‡ä»£å½“å‰å¯¹è±¡</p></li><li><p>object æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡å®ä¾‹  </p><blockquote><p>å¦‚æœæ˜¯é™æ€å¯¹è±¡ï¼Œé‚£ä¹ˆå°±æ˜¯ ç±»é”ï¼›<br>
å¦‚æœæ˜¯éé™æ€å¯¹è±¡ï¼šæˆå‘˜å¯¹è±¡å˜é‡ã€å±€éƒ¨å˜é‡ï¼ˆç”šè‡³å¯ä»¥æ˜¯ æ–¹æ³•å‚æ•°ï¼‰ï¼Œé‚£ä¹ˆå°±æ˜¯å¯¹è±¡é”</p></blockquote></li><li><p>object æ˜¯ä¸€ä¸ªç±»çš„class å¯¹è±¡ï¼Œé‚£ä¹ˆå°±æ˜¯ç±»é”</p></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="volatile"></a>volatile<a class="hash-link" href="#volatile" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">private volatile int account = 100;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>volatileå…³é”®å­—ä¸ºåŸŸå˜é‡çš„è®¿é—®æä¾›äº†ä¸€ç§å…é”æœºåˆ¶ï¼›</li><li>ä½¿ç”¨volatileä¿®é¥°åŸŸç›¸å½“äºå‘Šè¯‰è™šæ‹Ÿæœºè¯¥åŸŸå¯èƒ½ä¼šè¢«å…¶ä»–çº¿ç¨‹æ›´æ–°ï¼›</li><li>å› æ­¤æ¯æ¬¡ä½¿ç”¨è¯¥åŸŸå°±è¦é‡æ–°è®¡ç®—ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å¯„å­˜å™¨ä¸­çš„å€¼ï¼›</li><li>volatileä¸ä¼šæä¾›ä»»ä½•åŸå­æ“ä½œï¼Œå®ƒä¹Ÿä¸èƒ½ç”¨æ¥ä¿®é¥°finalç±»å‹çš„å˜é‡ã€‚</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="é‡å…¥é”ï¼ˆlockï¼‰"></a>é‡å…¥é”ï¼ˆLockï¼‰<a class="hash-link" href="#é‡å…¥é”ï¼ˆlockï¼‰" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ReentrantLock() : åˆ›å»ºä¸€ä¸ªReentrantLockå®ä¾‹         </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">lock() : è·å¾—é”        </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">unlock() : é‡Šæ”¾é”</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="å…¬å¹³é”éå…¬å¹³é”ï¼ˆå¤šçº¿ç¨‹æ‰§è¡Œé¡ºåºçš„ç»´åº¦ï¼‰"></a>å…¬å¹³é”/éå…¬å¹³é”ï¼ˆå¤šçº¿ç¨‹æ‰§è¡Œé¡ºåºçš„ç»´åº¦ï¼‰<a class="hash-link" href="#å…¬å¹³é”éå…¬å¹³é”ï¼ˆå¤šçº¿ç¨‹æ‰§è¡Œé¡ºåºçš„ç»´åº¦ï¼‰" title="Direct link to heading">#</a></h5><ul><li>å…¬å¹³é”ï¼šåŠ é”å‰å…ˆæŸ¥çœ‹æ˜¯å¦æœ‰æ’é˜Ÿç­‰å¾…çš„çº¿ç¨‹ï¼Œæœ‰çš„è¯ä¼˜å…ˆå¤„ç†æ’åœ¨å‰é¢çš„çº¿ç¨‹ï¼Œå…ˆæ¥å…ˆå¾—ã€‚</li><li>éå…¬å¹³æ‰€ï¼šçº¿ç¨‹åŠ é”æ—¶ç›´æ¥å°è¯•è·å–é”ï¼Œè·å–ä¸åˆ°å°±è‡ªåŠ¨åˆ°é˜Ÿå°¾ç­‰å¾…ã€‚</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">//åˆ›å»ºä¸€ä¸ªéå…¬å¹³é”ï¼Œé»˜è®¤æ˜¯éå…¬å¹³é”</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Lock nonFairLock= new ReentrantLock();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Lock nonFairLock= new ReentrantLock(false);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">//åˆ›å»ºä¸€ä¸ªå…¬å¹³é”ï¼Œæ„é€ ä¼ å‚true</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Lock fairLock= new ReentrantLock(true);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="ä¹è§‚é”æ‚²è§‚é”ï¼ˆå¤šçº¿ç¨‹æ“ä½œå…±äº«æ•°æ®çš„ç»´åº¦ï¼‰"></a>ä¹è§‚é”/æ‚²è§‚é”ï¼ˆå¤šçº¿ç¨‹æ“ä½œå…±äº«æ•°æ®çš„ç»´åº¦ï¼‰<a class="hash-link" href="#ä¹è§‚é”æ‚²è§‚é”ï¼ˆå¤šçº¿ç¨‹æ“ä½œå…±äº«æ•°æ®çš„ç»´åº¦ï¼‰" title="Direct link to heading">#</a></h5><ul><li>æ‚²è§‚é”ï¼šå‡è®¾ä¸€å®šä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œé€šè¿‡é˜»å¡å…¶ä»–æ‰€æœ‰çº¿ç¨‹æ¥ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚</li><li>ä¹è§‚é”ï¼šå‡è®¾ä¸ä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œç›´æ¥ä¸åŠ é”å»å®ŒæˆæŸé¡¹æ›´æ–°ï¼Œå¦‚æœå†²çªå°±è¿”å›å¤±è´¥ã€‚</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹é€šä¿¡"></a>çº¿ç¨‹é€šä¿¡<a class="hash-link" href="#çº¿ç¨‹é€šä¿¡" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="objectç±»çš„-waitã€notifyã€notifyall"></a>Objectç±»çš„ wait()ã€notify()ã€notifyAll()<a class="hash-link" href="#objectç±»çš„-waitã€notifyã€notifyall" title="Direct link to heading">#</a></h4><ul><li>çº¿ç¨‹æ‰§è¡Œwait()åï¼Œå°±æ”¾å¼ƒäº†è¿è¡Œèµ„æ ¼ï¼Œå¤„äºå†»ç»“çŠ¶æ€ï¼›</li><li>çº¿ç¨‹è¿è¡Œæ—¶ï¼Œå†…å­˜ä¸­ä¼šå»ºç«‹ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå†»ç»“çŠ¶æ€çš„çº¿ç¨‹éƒ½å­˜åœ¨äºçº¿ç¨‹æ± ä¸­ï¼Œnotify()æ‰§è¡Œæ—¶å”¤é†’çš„ä¹Ÿæ˜¯çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼Œçº¿ç¨‹æ± ä¸­æœ‰å¤šä¸ªçº¿ç¨‹æ—¶å”¤é†’ç¬¬ä¸€ä¸ªè¢«å†»ç»“çš„çº¿ç¨‹ã€‚</li><li>notifyall(), å”¤é†’çº¿ç¨‹æ± ä¸­æ‰€æœ‰çº¿ç¨‹ã€‚</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="conditionæ§åˆ¶çº¿ç¨‹é€šä¿¡"></a>Conditionæ§åˆ¶çº¿ç¨‹é€šä¿¡<a class="hash-link" href="#conditionæ§åˆ¶çº¿ç¨‹é€šä¿¡" title="Direct link to heading">#</a></h4><ul><li>å°†åŒæ­¥synchronizedæ›¿æ¢ä¸ºæ˜¾å¼çš„Lockæ“ä½œï¼›</li><li>å°†Objectç±»ä¸­çš„wait(), notify(),notifyAll()æ›¿æ¢æˆäº†Conditionå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ä»¥é€šè¿‡Locké”å¯¹è±¡è·å–;</li><li>ä¸€ä¸ªLockå¯¹è±¡ä¸Šå¯ä»¥ç»‘å®šå¤šä¸ªConditionå¯¹è±¡ï¼Œè¿™æ ·å®ç°äº†æœ¬æ–¹çº¿ç¨‹åªå”¤é†’å¯¹æ–¹çº¿ç¨‹ï¼Œè€Œjdk1.5ä¹‹å‰ï¼Œä¸€ä¸ªåŒæ­¥åªèƒ½æœ‰ä¸€ä¸ªé”ï¼Œä¸åŒçš„åŒæ­¥åªèƒ½ç”¨é”æ¥åŒºåˆ†ï¼Œä¸”é”åµŒå¥—æ—¶å®¹æ˜“æ­»é”ã€‚</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="é˜»å¡é˜Ÿåˆ—ï¼ˆblockingqueueï¼‰æ§åˆ¶çº¿ç¨‹é€šä¿¡"></a>é˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰æ§åˆ¶çº¿ç¨‹é€šä¿¡<a class="hash-link" href="#é˜»å¡é˜Ÿåˆ—ï¼ˆblockingqueueï¼‰æ§åˆ¶çº¿ç¨‹é€šä¿¡" title="Direct link to heading">#</a></h4><p>BlockingQueueæ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¹Ÿæ˜¯Queueçš„å­æ¥å£ã€‚<br>
BlockingQueueå…·æœ‰ä¸€ä¸ªç‰¹å¾ï¼šå½“ç”Ÿäº§è€…çº¿ç¨‹è¯•å›¾å‘BlockingQueueä¸­æ”¾å…¥å…ƒç´ æ—¶ï¼Œå¦‚æœè¯¥é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™çº¿ç¨‹è¢«é˜»å¡ï¼›ä½†æ¶ˆè´¹è€…çº¿ç¨‹è¯•å›¾ä»BlockingQueueä¸­å–å‡ºå…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—å·²ç©ºï¼Œåˆ™è¯¥çº¿ç¨‹é˜»å¡ã€‚ç¨‹åºçš„ä¸¤ä¸ªçº¿ç¨‹é€šè¿‡äº¤æ›¿å‘BlockingQueueä¸­æ”¾å…¥å…ƒç´ ã€å–å‡ºå…ƒç´ ï¼Œå³å¯å¾ˆå¥½åœ°æ§åˆ¶çº¿ç¨‹çš„é€šä¿¡ã€‚</p><p>BlockingQueueæä¾›å¦‚ä¸‹ä¸¤ä¸ªæ”¯æŒé˜»å¡çš„æ–¹æ³•ï¼š  </p><p>ï¼ˆ1ï¼‰put(E e)ï¼šå°è¯•æŠŠEuå…ƒç´ æ”¾å¦‚BlockingQueueä¸­ï¼Œå¦‚æœè¯¥é˜Ÿåˆ—çš„å…ƒç´ å·²æ»¡ï¼Œåˆ™é˜»å¡è¯¥çº¿ç¨‹ã€‚<br>
ï¼ˆ2ï¼‰takeï¼ˆï¼‰ï¼šå°è¯•ä»BlockingQueueçš„å¤´éƒ¨å–å‡ºå…ƒç´ ï¼Œå¦‚æœè¯¥é˜Ÿåˆ—çš„å…ƒç´ å·²ç©ºï¼Œåˆ™é˜»å¡è¯¥çº¿ç¨‹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ArrayBlockingQueue ï¼šåŸºäºæ•°ç»„å®ç°çš„BlockingQueueé˜Ÿåˆ—ã€‚</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">LinkedBlockingQueueï¼šåŸºäºé“¾è¡¨å®ç°çš„BlockingQueueé˜Ÿåˆ—ã€‚</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">PriorityBlockingQueueï¼šå®ƒå¹¶ä¸æ˜¯ä¿å‡†çš„é˜»å¡é˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—è°ƒç”¨removeï¼ˆï¼‰ã€pollï¼ˆï¼‰ã€takeï¼ˆï¼‰ç­‰æ–¹æ³•æå–å‡ºå…ƒç´ æ—¶ï¼Œå¹¶ä¸æ˜¯å–å‡ºé˜Ÿåˆ—ä¸­å­˜åœ¨æ—¶é—´æœ€é•¿çš„å…ƒç´ ï¼Œè€Œæ˜¯é˜Ÿåˆ—ä¸­æœ€å°çš„å…ƒç´ ã€‚</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                       å®ƒåˆ¤æ–­å…ƒç´ çš„å¤§å°å³å¯æ ¹æ®å…ƒç´ ï¼ˆå®ç°Comparableæ¥å£ï¼‰çš„æœ¬èº«å¤§å°æ¥è‡ªç„¶æ’åºï¼Œä¹Ÿå¯ä½¿ç”¨Comparatorè¿›è¡Œå®šåˆ¶æ’åºã€‚</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">SynchronousQueueï¼šåŒæ­¥é˜Ÿåˆ—ã€‚å¯¹è¯¥é˜Ÿåˆ—çš„å­˜ã€å–æ“ä½œå¿…é¡»äº¤æ›¿è¿›è¡Œã€‚</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">DelayQueueï¼šå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„BlockingQueueï¼Œåº•å±‚åŸºäºPriorityBlockingQueueå®ç°ï¼Œä¸è¿‡ï¼ŒDelayQueueè¦æ±‚é›†åˆå…ƒç´ éƒ½å®ç°Delayæ¥å£ï¼ˆè¯¥æ¥å£é‡Œåªæœ‰ä¸€ä¸ªlong getDelayï¼ˆï¼‰æ–¹æ³•ï¼‰ï¼Œ</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            DelayQueueæ ¹æ®é›†åˆå…ƒç´ çš„getDalayï¼ˆï¼‰æ–¹æ³•çš„è¿”å›å€¼è¿›è¡Œæ’åºã€‚</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="threadlocal"></a>ThreadLocal<a class="hash-link" href="#threadlocal" title="Direct link to heading">#</a></h4><p>æä¾›çº¿ç¨‹æœ¬åœ°å˜é‡ï¼Œå¦‚æœåˆ›å»ºä¸€ä¸ª <code>ThreadLocal</code> å˜é‡ï¼Œé‚£ä¹ˆè®¿é—®è¿™ä¸ªå˜é‡çš„æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæœ‰è¿™ä¸ªå˜é‡çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œ
åœ¨å®é™…å¤šçº¿ç¨‹æ“ä½œçš„æ—¶å€™ï¼Œæ“ä½œçš„æ˜¯è‡ªå·±æœ¬åœ°å†…å­˜ä¸­çš„å˜é‡ï¼Œä»è€Œè§„é¿äº†çº¿ç¨‹å®‰å…¨é—®é¢˜</p><p><img src="/docs.advanced.way/assets/images/1368768-20190614000329689-872917045-d0034fb95f26d81b837b1f8d2f1ad934.png"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public class ThreadLocal&lt;T&gt; {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private final int threadLocalHashCode = nextHashCode();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private static final int HASH_INCREMENT = 0x61c88647;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private static AtomicInteger nextHashCode = new AtomicInteger();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    private static int nextHashCode() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        return nextHashCode.getAndAdd(HASH_INCREMENT);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    static class ThreadLocalMap {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        static class Entry extends WeakReference&lt;ThreadLocal&lt;?&gt;&gt; {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            Object value;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            Entry(ThreadLocal&lt;?&gt; k, Object v) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                super(k);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                value = v;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        private static final int INITIAL_CAPACITY = 16;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        private Entry[] table;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        private int size = 0;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        private int threshold;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        ThreadLocalMap(ThreadLocal&lt;?&gt; firstKey, Object firstValue) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            table = new Entry[INITIAL_CAPACITY];</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            int i = firstKey.threadLocalHashCode &amp; (INITIAL_CAPACITY - 1);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            // åˆ›å»ºèŠ‚ç‚¹å¹¶èµ‹å€¼</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            table[i] = new Entry(firstKey, firstValue);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            size = 1;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            setThreshold(INITIAL_CAPACITY);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        private Entry getEntry(ThreadLocal&lt;?&gt; key) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            int i = key.threadLocalHashCode &amp; (table.length - 1);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            Entry e = table[i];</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            if (e != null &amp;&amp; e.get() == key)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                return e;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            else</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                return getEntryAfterMiss(key, i, e);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        private void set(ThreadLocal&lt;?&gt; key, Object value) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            // We don&#x27;t use a fast path as with get() because it is at</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            // least as common to use set() to create new entries as</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            // it is to replace existing ones, in which case, a fast</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            // path would fail more often than not.</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            Entry[] tab = table;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            int len = tab.length;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            int i = key.threadLocalHashCode &amp; (len-1);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            for (Entry e = tab[i];</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 e != null;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                 e = tab[i = nextIndex(i, len)]) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                ThreadLocal&lt;?&gt; k = e.get();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                if (k == key) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    e.value = value;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    return;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                if (k == null) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    replaceStaleEntry(key, value, i);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    return;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            tab[i] = new Entry(key, value);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            int sz = ++size;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            if (!cleanSomeSlots(i, sz) &amp;&amp; sz &gt;= threshold)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                rehash();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        // æ‰©å®¹</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        private void resize() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            Entry[] oldTab = table;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            int oldLen = oldTab.length;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            int newLen = oldLen * 2;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            Entry[] newTab = new Entry[newLen];</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            int count = 0;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            for (Entry e : oldTab) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                if (e != null) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    ThreadLocal&lt;?&gt; k = e.get();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    if (k == null) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                        e.value = null; // Help the GC</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    } else {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                        int h = k.threadLocalHashCode &amp; (newLen - 1);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                        while (newTab[h] != null)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                            h = nextIndex(h, newLen);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                        newTab[h] = e;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                        count++;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            setThreshold(newLen);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            size = count;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            table = newTab;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // åˆ›å»ºå®ä¾‹</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public ThreadLocal() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    ThreadLocalMap getMap(Thread t) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        return t.threadLocals;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public void set(T value) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        Thread t = Thread.currentThread();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        // è·å–çº¿ç¨‹ threadLocals</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        ThreadLocalMap map = getMap(t);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        if (map != null) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            // è®¾ç½®å€¼</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            map.set(this, value);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        } else {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            createMap(t, value);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // åˆ›å»ºä¸€ä¸ª ThreadLocalMap</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    void createMap(Thread t, T firstValue) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        t.threadLocals = new ThreadLocalMap(this, firstValue);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // è·å–å€¼</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public T get() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        Thread t = Thread.currentThread();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        ThreadLocalMap map = getMap(t);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        if (map != null) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            // è·å–å®ä½“å…ƒç´ </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            ThreadLocalMap.Entry e = map.getEntry(this);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            if (e != null) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                @SuppressWarnings(&quot;unchecked&quot;)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                // è·å–å€¼</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                T result = (T)e.value;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                return result;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        return setInitialValue();</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    // ç§»é™¤</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    public void remove() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         ThreadLocalMap m = getMap(Thread.currentThread());</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         if (m != null) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">             m.remove(this);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">         }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">     }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹æ± "></a>çº¿ç¨‹æ± <a class="hash-link" href="#çº¿ç¨‹æ± " title="Direct link to heading">#</a></h2><p>åœ¨ä½¿ç”¨çº¿ç¨‹æ± ä¹‹åï¼Œåˆ›å»ºçº¿ç¨‹å˜æˆäº†ä»çº¿ç¨‹æ± è·å¾—ç©ºé—²çº¿ç¨‹ï¼Œå…³é—­çº¿ç¨‹å˜æˆäº†å‘çº¿ç¨‹æ± å½’è¿˜çº¿ç¨‹ã€‚<br>
å¥½å¤„:  </p><ul><li>é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</li><li>æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚</li><li>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="å†…ç½®çº¿ç¨‹æ± "></a>å†…ç½®çº¿ç¨‹æ± <a class="hash-link" href="#å†…ç½®çº¿ç¨‹æ± " title="Direct link to heading">#</a></h3><p>DKå¹¶å‘åŒ…ä¸­æä¾›äº†ä¸€å¥—Executorçº¿ç¨‹æ± æ¡†æ¶ã€‚Executorsç±»ä¸ºçº¿ç¨‹æ± å·¥å‚ï¼Œé€šè¿‡Executorså¯ä»¥å–å¾—ä¸€ä¸ªæ‹¥æœ‰ç‰¹å®šåŠŸèƒ½çš„çº¿ç¨‹æ± </p><p>Executorçº¿ç¨‹æ± æ¡†æ¶çš„æœ€å¤§ä¼˜ç‚¹æ˜¯æŠŠä»»åŠ¡çš„æäº¤å’Œæ‰§è¡Œè§£è€¦
<img src="/docs.advanced.way/assets/images/java-7-concurrent-executors-uml-class-diagram-example-5a060fcf244bf15c9a95fb91837c8677.png"></p><p>ä½¿ç”¨Executorsæ‰§è¡Œå¤šçº¿ç¨‹ä»»åŠ¡çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>  â€¢ è°ƒç”¨Executorsç±»çš„é™æ€å·¥å‚æ–¹æ³•åˆ›å»ºä¸€ä¸ªExecutorServiceå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä»£è¡¨ä¸€ä¸ªçº¿ç¨‹æ± ï¼›</p><p>  â€¢ åˆ›å»ºRunnableå®ç°ç±»æˆ–Callableå®ç°ç±»çš„å®ä¾‹ï¼Œä½œä¸ºçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼›</p><p>  â€¢ è°ƒç”¨ExecutorServiceå¯¹è±¡çš„submit()æ–¹æ³•æ¥æäº¤Runnableå®ä¾‹æˆ–Callableå®ä¾‹ï¼›</p><p>  â€¢ å½“ä¸æƒ³æäº¤ä»»åŠ¡æ—¶ï¼Œè°ƒç”¨ExecutorServiceå¯¹è±¡çš„shutdown()æ–¹æ³•æ¥å…³é—­çº¿ç¨‹æ± </p><p>newFixedThreadPool()ï¼šé€šè¿‡è¯¥å·¥å‚æ–¹æ³•è¿”å›ä¸€ä¸ªå›ºå®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å§‹ç»ˆä¸å˜ã€‚å½“æ²¡æœ‰ç©ºé—²çº¿ç¨‹æ—¶ï¼Œæ–°æäº¤çš„ä»»åŠ¡åˆ™è¢«æš‚å­˜åœ¨ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚</p><p>newSingleThreadExecutor()ï¼šé€šè¿‡è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚å¤šä½™çš„ä»»åŠ¡è¢«ä¿å­˜åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå¾…çº¿ç¨‹ç©ºé—²ï¼ŒæŒ‰å…ˆè¿›å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</p><p>newCachedThreadPool()ï¼šé€šè¿‡è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´çº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡ä¸ç¡®å®šï¼Œå½“æ‰€æœ‰çº¿ç¨‹éƒ½åœ¨å·¥ä½œæ—¶ï¼Œåˆæœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œåˆ™ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ã€‚æ‰€æœ‰çº¿ç¨‹åœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå°†è¿”å›çº¿ç¨‹æ± è¿›è¡Œå¤ç”¨ã€‚</p><p>newSingleThreadScheduledExecutor()ï¼šé€šè¿‡è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªSheduledExecutorServiceå¯¹è±¡ï¼Œçº¿ç¨‹æ± å¤§å°ä¸º1ã€‚SheduledExecutorServiceæ¥å£åœ¨ExecutorServiceæ¥å£ä¸Šæ‰©å±•äº†åœ¨ç»™å®šæ—¶é—´æ‰§è¡ŒæŸä»»åŠ¡çš„åŠŸèƒ½ï¼Œå¦‚åœ¨æŸä¸ªå›ºå®šæ—¶å»¶ä¹‹åæ‰§è¡Œï¼Œæˆ–è€…å‘¨æœŸæ€§æ‰§è¡ŒæŸä¸ªä»»åŠ¡ã€‚</p><p>newScheduledThreadPool()ï¼šé€šè¿‡è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªSheduledExecutorServiceçš„å¯¹è±¡ï¼Œä½†è¯¥çº¿ç¨‹æ± å¯ä»¥æŒ‡å®šçº¿ç¨‹æ•°é‡</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹æ± å‚æ•°"></a>çº¿ç¨‹æ± å‚æ•°<a class="hash-link" href="#çº¿ç¨‹æ± å‚æ•°" title="Direct link to heading">#</a></h3><p>å†…éƒ¨å®ç°å‡ä½¿ç”¨äº†ThreadPoolExecutorå®ç°ï¼Œéƒ½æ˜¯é€šè¿‡ThreadPoolExecutorç±»è¿›è¡Œå°è£…ä¹‹åå¾—åˆ°çš„ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨ThreadPoolExecutoræ„é€ å‡½æ•°ä¸­æŒ‡å®šä¸åŒçš„å‚æ•°æ¥æ„é€ ä¸åŒçš„çº¿ç¨‹æ± </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public ThreadPoolExecutor(</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            int corePoolSize,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            int maxnumPoolSize,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            long keepAliveTime,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            TimeUnit unit,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            BlockingQueue&lt;Runnable&gt; workQueue,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            ThreadFactory threadFactory,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            RejectedExecutionHandler handler</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            )</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>corePoolSize:æŒ‡å®šäº†çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡ã€‚</li><li>maxnumPoolSize:æŒ‡å®šäº†çº¿ç¨‹æ± ä¸­çš„æœ€å¤§çº¿ç¨‹æ•°é‡ã€‚</li><li>keepAliveTime:å½“çº¿ç¨‹æ± çº¿ç¨‹æ•°é‡è¶…è¿‡corePoolSizeæ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹çš„å­˜æ´»æ—¶é—´ï¼Œå³è¶…è¿‡corePoolSizeçš„ç©ºé—²çº¿ç¨‹åœ¨å¤šé•¿çš„æ—¶é—´å†…ä¼šè¢«é”€æ¯ã€‚</li><li>unit: keepAliveTimeçš„å•ä½ã€‚</li><li>workQueue:ä»»åŠ¡é˜Ÿåˆ—ï¼Œè¢«æäº¤ä½†å°šæœªè¢«æ‰§è¡Œçš„ä»»åŠ¡ã€‚</li><li>threadFactory:çº¿ç¨‹å·¥å‚ï¼Œç”¨äºåˆ›å»ºçº¿ç¨‹ï¼Œä¸€èˆ¬ç”¨é»˜è®¤çš„å³å¯ã€‚</li><li>handler:æ‹’ç»ç­–ç•¥ï¼Œå½“ä»»åŠ¡å¤ªå¤šæ¥ä¸åŠå¤„ç†æ—¶æ‹’ç»æ‰§è¡Œçš„ç­–ç•¥ã€‚</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ä»»åŠ¡é˜Ÿåˆ—"></a>ä»»åŠ¡é˜Ÿåˆ—<a class="hash-link" href="#ä»»åŠ¡é˜Ÿåˆ—" title="Direct link to heading">#</a></h4><p>å‚æ•°ä»»åŠ¡é˜Ÿåˆ—æŒ‡è¢«æäº¤ä½†æ˜¯æœªæ‰§è¡Œçš„é˜Ÿåˆ—ä»»åŠ¡ï¼Œå®ƒæ˜¯ä¸€ä¸ªBlockingQueueæ¥å£çš„å¯¹è±¡ï¼Œç”¨äºå­˜æ”¾Runnableå¯¹è±¡</p><p>(1)	ç›´æ¥æäº¤çš„é˜Ÿåˆ—ï¼šè¯¥åŠŸèƒ½ç”±SynchronizedQueueå¯¹è±¡æä¾›ã€‚SynchronizedQueueæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„é˜»å¡é˜Ÿåˆ—ã€‚SynchronizedQueueæ²¡æœ‰å®¹é‡ï¼Œæ¯ä¸€ä¸ªæ’å…¥æ“ä½œéƒ½è¦ç­‰å¾…ä¸€ä¸ªç›¸åº”çš„åˆ é™¤æ“ä½œï¼Œåä¹‹æ¯ä¸€ä¸ªåˆ é™¤æ“ä½œéƒ½éœ€è¦ç­‰å¾…å¯¹åº”çš„æ’å…¥æ“ä½œã€‚ä½¿ç”¨SynchronizedQueueæ—¶æäº¤çš„ä»»åŠ¡ä¸ä¼šè¢«çœŸå®çš„ä¿å­˜ï¼Œè€Œæ€»æ˜¯å°†æ–°ä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ‰§è¡Œï¼Œå¦‚æœæ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹åˆ™å°è¯•åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œå¦‚æœçº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§å€¼å°±æ‰§è¡Œå†³ç»ç­–ç•¥ã€‚ä½¿ç”¨SynchronizedQueueé˜Ÿåˆ—é€šå¸¸è¦è®¾ç½®å¾ˆå¤§çš„maxnumPoolSizeï¼Œå¦åˆ™å¾ˆå®¹æ˜“æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚å¯ä»¥å½“åšå¤§å°ä¸º0çš„é˜Ÿåˆ—æ¥ç†è§£ã€‚</p><p>(2)	æœ‰ç•Œçš„ä»»åŠ¡é˜Ÿåˆ—ï¼šæœ‰ç•Œçš„ä»»åŠ¡é˜Ÿåˆ—å¯ä»¥ä½¿ç”¨ArrayBlockingQueueå®ç°ã€‚å½“ä½¿ç”¨æœ‰ç•Œçš„ä»»åŠ¡é˜Ÿåˆ—æ—¶ï¼Œè‹¥æœ‰æ–°çš„ä»»åŠ¡éœ€è¦æ‰§è¡Œï¼Œå¦‚æœçº¿ç¨‹æ± çš„å®é™…çº¿ç¨‹æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œåˆ™æœ‰ä¼˜å…ˆåˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œè‹¥å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œåˆ™ä¼šå°†æ–°ä»»åŠ¡åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚è‹¥é˜Ÿåˆ—å·²æ»¡ï¼Œæ— æ³•åŠ å…¥åˆ™åœ¨æ€»çº¿ç¨‹æ•°ä¸å¤§äºæœ€å¤§çº¿ç¨‹æ•°çš„å‰æä¸‹ï¼Œåˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚è‹¥å¤§äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œåˆ™æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰ç•Œé˜Ÿåˆ—ä»…å½“ä»»åŠ¡é˜Ÿåˆ—æ»¡æ—¶æ‰å¯èƒ½å°†çº¿ç¨‹æ•°æå‡åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°åªä¸Šï¼Œå¦åˆ™ç¡®ä¿çº¿ç¨‹æ•°ç»´æŒåœ¨æ ¸å¿ƒçº¿ç¨‹æ•°å¤§å°ã€‚</p><p>(3)	æ— ç•Œä»»åŠ¡é˜Ÿåˆ—ï¼šæ— ç•Œä»»åŠ¡é˜Ÿåˆ—å¯ä»¥é€šè¿‡LinkedBlockingQueueç±»æ¥å®ç°ã€‚ä¸æœ‰ç•Œé˜Ÿåˆ—ç›¸æ¯”ï¼Œé™¤éç³»ç»Ÿèµ„æºè€—å°½ï¼Œå¦åˆ™æ— ç•Œé˜Ÿåˆ—ä¸å­˜åœ¨ä»»åŠ¡å…¥é˜Ÿå¤±è´¥çš„æƒ…å†µã€‚å½“æœ‰æ–°çš„ä»»åŠ¡åˆ°æ¥ï¼Œç³»ç»Ÿçš„çº¿ç¨‹æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶çº¿ç¨‹æ± ä¼šç”Ÿæˆæ–°çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œä½†å½“ç³»ç»Ÿçº¿ç¨‹æ•°å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°åï¼Œå°±ä¸ä¼šç»§ç»­å¢åŠ ã€‚è‹¥åç»­æœ‰æ–°çš„ä»»åŠ¡ï¼Œåˆ™å°†ä»»åŠ¡æ”¾å…¥æ— ç•Œé˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚</p><p>(4)	ä¼˜å…ˆä»»åŠ¡é˜Ÿåˆ—ï¼šä¼˜å…ˆä»»åŠ¡é˜Ÿåˆ—æ˜¯å¸¦æœ‰æ‰§è¡Œä¼˜å…ˆçº§çš„é˜Ÿåˆ—ï¼Œé€šè¿‡PriorityBlockingQueueå®ç°ï¼Œå¯ä»¥æ§åˆ¶ä»»åŠ¡çš„æ‰§è¡Œå…ˆåé¡ºåºï¼Œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ— ç•Œé˜Ÿåˆ—ã€‚æ— è®ºæ˜¯æœ‰ç•Œé˜Ÿåˆ—è¿˜ArrayBlockingQueueè¿˜æ˜¯æœªæŒ‡å®šå¤§å°çš„æ— ç•Œé˜Ÿåˆ—LinkedBlockingQueueï¼Œéƒ½æ˜¯æŒ‰ç…§å…ˆè¿›å…ˆå‡ºç®—æ³•å¤„ç†ä»»åŠ¡çš„ï¼Œè€Œæœ‰é™é˜Ÿåˆ—åˆ™å¯ä»¥æ ¹æ®ä»»åŠ¡è‡ªèº«çš„ä¼˜å…ˆçº§é¡ºåºæ‰§è¡Œï¼Œåœ¨ç¡®ä¿ç³»ç»Ÿæ€§èƒ½çš„åŒæ—¶ï¼Œä¹Ÿèƒ½æœ‰å¾ˆå¥½çš„è´¨é‡ä¿è¯ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="æ‹’ç»ç­–ç•¥"></a>æ‹’ç»ç­–ç•¥<a class="hash-link" href="#æ‹’ç»ç­–ç•¥" title="Direct link to heading">#</a></h4><p>å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹å·²ç»ç”¨å®Œï¼Œæ— æ³•ç»§ç»­ä¸ºæ–°ä»»åŠ¡æœåŠ¡ï¼ŒåŒæ—¶ç­‰å¾…é˜Ÿåˆ—ä¸­å·²ç»æ’æ»¡ï¼Œå†ä¹Ÿå¡ä¸ä¸‹æ–°ä»»åŠ¡äº†</p><ul><li>AbortPolicyï¼šè¯¥ç­–ç•¥ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œé˜»æ­¢ç³»ç»Ÿæ­£å¸¸å·¥ä½œã€‚</li><li>CallerRunsPolicyï¼šåªè¦çº¿ç¨‹æ± æœªå…³é—­ï¼Œè¯¥ç­–ç•¥ç›´æ¥åœ¨è°ƒç”¨è€…çº¿ç¨‹ä¸­è¿è¡Œå½“å‰è¢«ä¸¢å¼ƒçš„ä»»åŠ¡ã€‚æ˜¾ç„¶è¿™æ ·åšä¸ä¼šçœŸçš„ä¸¢å¼ƒä»»åŠ¡ï¼Œä½†æ˜¯ä»»åŠ¡æäº¤çº¿ç¨‹çš„æ€§èƒ½å¯èƒ½ä¼šæ€¥å‰§ä¸‹é™ã€‚</li><li>DiscardOledestPolicyï¼šè¯¥ç­–ç•¥å°†ä¸¢å¼ƒæœ€è€çš„ä¸€ä¸ªè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯å³å°†è¢«æ‰§è¡Œçš„ä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶å°è¯•å†æ¬¡æäº¤å½“å‰ä»»åŠ¡ã€‚</li><li>DiscardPolicyï¼šè¯¥ç­–ç•¥é»˜é»˜ä¸¢å¼ƒæ— æ³•å¤„ç†çš„ä»»åŠ¡ï¼Œä¸äºˆä»»ä½•å¤„ç†ã€‚åœ¨å…è®¸ä»»åŠ¡ä¸¢å¤±çš„æƒ…å†µä¸‹è¿™æ˜¯ä¸€ç§åˆé€‚çš„æ–¹æ¡ˆã€‚</li></ul><p>ä»¥ä¸Šå†…ç½®çš„ç­–ç•¥å‡å®ç°äº†RejectedExecutionHandleræ¥å£ï¼Œè‹¥ä»æ— æ³•æ»¡è¶³å®é™…éœ€è¦ï¼Œå¯ä»¥è‡ªå·±æ‰©å±•RejectedExecutionHandleræ¥å£ï¼Œé€šè¿‡å¤å†™rejectedExecutionæ–¹æ³•ï¼Œæ¥å®ç°è‡ªå·±é¥¿æ‹’ç»ç­–ç•¥</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public ThreadPoolExecutor(5,5,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                0L,TimeUnit.MICROSECONDS,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                new LinkedBlockingQueue&lt;Runnable&gt;(10),</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                Executors.defaultThreadFactory(),</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                new RejectedExecutionHandler() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    public void rejected(Runnable r, ThreadPoolExecutor executor) {  </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                      System.out.println(r.toString()+&quot;is discard&quot;);                                                          </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                });</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹æ± æ‰©å±•"></a>çº¿ç¨‹æ± æ‰©å±•<a class="hash-link" href="#çº¿ç¨‹æ± æ‰©å±•" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ExecutorService eService = new ThreadPoolExecutor(5,5,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        0L,TimeUnit.MICROSECONDS,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        new LinkedBlockingQueue&lt;Runnable&gt;(10),</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        Executors.defaultThreadFactory(),</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        new RejectedExecutionHandler() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            public void rejectedExecution(Runnable r, ThreadPoolExecutor executor) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                System.out.println(r.toString()+&quot;is discard&quot;);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            @Override</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            protected void beforeExecute(Thread thread ,Runnable r){</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                System.out.println(&quot;å‡†å¤‡æ‰§è¡Œ&quot;+((MyTask)r).name);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            @Override</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            protected void afterExecute(Runnable r,Throwable t){</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                System.out.println(&quot;æ‰§è¡Œå®Œæˆ&quot;+((MyTask)r).name);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">};</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="executorserviceæœ‰å¦‚ä¸‹å‡ ä¸ªæ‰§è¡Œæ–¹æ³•"></a>ExecutorServiceæœ‰å¦‚ä¸‹å‡ ä¸ªæ‰§è¡Œæ–¹æ³•<a class="hash-link" href="#executorserviceæœ‰å¦‚ä¸‹å‡ ä¸ªæ‰§è¡Œæ–¹æ³•" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">- execute(Runnable)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">- submit(Runnable)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">- submit(Callable)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">- invokeAny(...)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">- invokeAll(...)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="submitrunnable"></a>submit(Runnable)<a class="hash-link" href="#submitrunnable" title="Direct link to heading">#</a></h5><p>   submit(Runnable)å’Œexecute(Runnable)åŒºåˆ«æ˜¯å‰è€…å¯ä»¥è¿”å›ä¸€ä¸ªFutureå¯¹è±¡ï¼Œé€šè¿‡è¿”å›çš„Futureå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥æäº¤çš„ä»»åŠ¡æ˜¯å¦æ‰§è¡Œå®Œæ¯•ï¼Œè¯·çœ‹ä¸‹é¢æ‰§è¡Œçš„ä¾‹å­ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Future future = executorService.submit(new Runnable() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">public void run() {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    System.out.println(&quot;Asynchronous task&quot;);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">});</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">future.get();  //returns null if the task has finished correctly.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>æ³¨ï¼šå¦‚æœä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œfuture.get()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªnullã€‚æ³¨æ„ï¼Œfuture.get()æ–¹æ³•ä¼šäº§ç”Ÿé˜»å¡ã€‚</p></blockquote><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="invokeany"></a>invokeAny(â€¦)<a class="hash-link" href="#invokeany" title="Direct link to heading">#</a></h5><p>invokeAny(...)æ–¹æ³•æ¥æ”¶çš„æ˜¯ä¸€ä¸ªCallableçš„é›†åˆï¼Œæ‰§è¡Œè¿™ä¸ªæ–¹æ³•ä¸ä¼šè¿”å›Futureï¼Œä½†æ˜¯ä¼šè¿”å›æ‰€æœ‰Callableä»»åŠ¡ä¸­å…¶ä¸­ä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœã€‚è¿™ä¸ªæ–¹æ³•ä¹Ÿæ— æ³•ä¿è¯è¿”å›çš„æ˜¯å“ªä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œåæ­£æ˜¯å…¶ä¸­çš„æŸä¸€ä¸ª</p><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="invokeall"></a>invokeAll(â€¦)<a class="hash-link" href="#invokeall" title="Direct link to heading">#</a></h5><p>invokeAll(...)ä¸ invokeAny(...)ç±»ä¼¼ä¹Ÿæ˜¯æ¥æ”¶ä¸€ä¸ªCallableé›†åˆï¼Œä½†æ˜¯å‰è€…æ‰§è¡Œä¹‹åä¼šè¿”å›ä¸€ä¸ªFutureçš„Listï¼Œå…¶ä¸­å¯¹åº”ç€æ¯ä¸ªCallableä»»åŠ¡æ‰§è¡Œåçš„Futureå¯¹è±¡</p><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="executorserviceå…³é—­æ–¹æ³•"></a>ExecutorServiceå…³é—­æ–¹æ³•<a class="hash-link" href="#executorserviceå…³é—­æ–¹æ³•" title="Direct link to heading">#</a></h5><p> å½“æˆ‘ä»¬ä½¿ç”¨å®ŒæˆExecutorServiceä¹‹ååº”è¯¥å…³é—­å®ƒï¼Œå¦åˆ™å®ƒé‡Œé¢çš„çº¿ç¨‹ä¼šä¸€ç›´å¤„äºè¿è¡ŒçŠ¶æ€ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœçš„åº”ç”¨ç¨‹åºæ˜¯é€šè¿‡main()æ–¹æ³•å¯åŠ¨çš„ï¼Œåœ¨è¿™ä¸ªmain()é€€å‡ºä¹‹åï¼Œå¦‚æœåº”ç”¨ç¨‹åºä¸­çš„ExecutorServiceæ²¡æœ‰å…³é—­ï¼Œè¿™ä¸ªåº”ç”¨å°†ä¸€ç›´è¿è¡Œã€‚ä¹‹æ‰€ä»¥ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œæ˜¯å› ä¸ºExecutorServiceä¸­è¿è¡Œçš„çº¿ç¨‹ä¼šé˜»æ­¢JVMå…³é—­ã€‚</p><p>  è¦å…³é—­ExecutorServiceä¸­æ‰§è¡Œçš„çº¿ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ExecutorService.shutdown()æ–¹æ³•ã€‚åœ¨è°ƒç”¨shutdown()æ–¹æ³•ä¹‹åï¼ŒExecutorServiceä¸ä¼šç«‹å³å…³é—­ï¼Œä½†æ˜¯å®ƒä¸å†æ¥æ”¶æ–°çš„ä»»åŠ¡ï¼Œç›´åˆ°å½“å‰æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæˆæ‰ä¼šå…³é—­ï¼Œæ‰€æœ‰åœ¨shutdown()æ‰§è¡Œä¹‹å‰æäº¤çš„ä»»åŠ¡éƒ½ä¼šè¢«æ‰§è¡Œã€‚</p><p>  å¦‚æœæƒ³ç«‹å³å…³é—­ExecutorServiceï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ExecutorService.shutdownNow()æ–¹æ³•ã€‚è¿™ä¸ªåŠ¨ä½œå°†è·³è¿‡æ‰€æœ‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡å’Œè¢«æäº¤è¿˜æ²¡æœ‰æ‰§è¡Œçš„ä»»åŠ¡ã€‚ä½†æ˜¯å®ƒå¹¶ä¸å¯¹æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡åšä»»ä½•ä¿è¯ï¼Œæœ‰å¯èƒ½å®ƒä»¬éƒ½ä¼šåœæ­¢ï¼Œä¹Ÿæœ‰å¯èƒ½æ‰§è¡Œå®Œæˆã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="æ­»é”"></a>æ­»é”<a class="hash-link" href="#æ­»é”" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="æ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶"></a>æ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶<a class="hash-link" href="#æ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶" title="Direct link to heading">#</a></h4><ul><li>äº’æ–¥æ¡ä»¶ï¼šèµ„æºä¸èƒ½è¢«å…±äº«ï¼Œåªèƒ½è¢«åŒä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨</li><li>è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šå·²ç»å¾—åˆ°èµ„æºçš„è¿›ç¨‹å¯ä»¥ç”³è¯·æ–°çš„èµ„æº</li><li>éå‰¥å¤ºæ¡ä»¶ï¼šå·²ç»åˆ†é…çš„èµ„æºä¸èƒ½ä»ç›¸åº”çš„è¿›ç¨‹ä¸­è¢«å¼ºåˆ¶å‰¥å¤º</li><li>å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šç³»ç»Ÿä¸­è‹¥å¹²è¿›ç¨‹ç»„æˆç¯è·¯ï¼Œè¯¥ç¯è·¯ä¸­æ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…ç›¸é‚»è¿›ç¨‹å ç”¨çš„èµ„æº</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="å¤„ç†æ­»é”çš„æ–¹æ³•"></a>å¤„ç†æ­»é”çš„æ–¹æ³•<a class="hash-link" href="#å¤„ç†æ­»é”çš„æ–¹æ³•" title="Direct link to heading">#</a></h4><ul><li>å¿½ç•¥è¯¥é—®é¢˜ï¼Œä¹Ÿå³é¸µé¸Ÿç®—æ³•ã€‚å½“å‘ç”Ÿäº†ä»€ä¹ˆé—®é¢˜æ—¶ï¼Œä¸ç®¡ä»–ï¼Œç›´æ¥è·³è¿‡ï¼Œæ— è§†å®ƒ;</li><li>æ£€æµ‹æ­»é”å¹¶æ¢å¤;</li><li>èµ„æºè¿›è¡ŒåŠ¨æ€åˆ†é…;</li><li>ç ´é™¤ä¸Šé¢çš„å››ç§æ­»é”æ¡ä»¶ä¹‹ä¸€;</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/Goldwood1024/docs.advanced.way/docs/docs/java/hc/å¤šçº¿ç¨‹.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-03-22T07:06:00.000Z" class="lastUpdatedDate_1WI_">3/22/2021</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs.advanced.way/docs/java/hc/é«˜å¹¶å‘"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« é«˜å¹¶å‘</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs.advanced.way/docs/java/hc/å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#çº¿ç¨‹" class="table-of-contents__link">çº¿ç¨‹</a><ul><li><a href="#å¹¶å‘å’Œå¹¶è¡Œ" class="table-of-contents__link">å¹¶å‘å’Œå¹¶è¡Œ</a></li><li><a href="#çº¿ç¨‹çŠ¶æ€" class="table-of-contents__link">çº¿ç¨‹çŠ¶æ€</a></li><li><a href="#åˆ›å»ºçº¿ç¨‹" class="table-of-contents__link">åˆ›å»ºçº¿ç¨‹</a></li><li><a href="#çº¿ç¨‹ç®¡ç†" class="table-of-contents__link">çº¿ç¨‹ç®¡ç†</a></li><li><a href="#çº¿ç¨‹è°ƒåº¦" class="table-of-contents__link">çº¿ç¨‹è°ƒåº¦</a></li><li><a href="#çº¿ç¨‹åŒæ­¥" class="table-of-contents__link">çº¿ç¨‹åŒæ­¥</a></li><li><a href="#çº¿ç¨‹é€šä¿¡" class="table-of-contents__link">çº¿ç¨‹é€šä¿¡</a></li></ul></li><li><a href="#çº¿ç¨‹æ± " class="table-of-contents__link">çº¿ç¨‹æ± </a><ul><li><a href="#å†…ç½®çº¿ç¨‹æ± " class="table-of-contents__link">å†…ç½®çº¿ç¨‹æ± </a></li><li><a href="#çº¿ç¨‹æ± å‚æ•°" class="table-of-contents__link">çº¿ç¨‹æ± å‚æ•°</a></li><li><a href="#æ­»é”" class="table-of-contents__link">æ­»é”</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 è¿›é˜¶ä¹‹è·¯, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docs.advanced.way/assets/js/styles.d2979f79.js"></script>
<script src="/docs.advanced.way/assets/js/runtime~main.c79be437.js"></script>
<script src="/docs.advanced.way/assets/js/main.a0c081f8.js"></script>
<script src="/docs.advanced.way/assets/js/1.68ccfdd8.js"></script>
<script src="/docs.advanced.way/assets/js/2.0ae89a79.js"></script>
<script src="/docs.advanced.way/assets/js/3.ef70b8bc.js"></script>
<script src="/docs.advanced.way/assets/js/1be78505.8900d4c5.js"></script>
<script src="/docs.advanced.way/assets/js/202.499d5c45.js"></script>
<script src="/docs.advanced.way/assets/js/935f2afb.410f6dda.js"></script>
<script src="/docs.advanced.way/assets/js/17896441.a99ce0cd.js"></script>
<script src="/docs.advanced.way/assets/js/e7ff1b1e.2e6811a0.js"></script>
</body>
</html>