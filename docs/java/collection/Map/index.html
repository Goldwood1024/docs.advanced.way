<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.75">
<link rel="alternate" type="application/rss+xml" href="/docs.advanced.way/blog/rss.xml" title="è¿›é˜¶ä¹‹è·¯ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs.advanced.way/blog/atom.xml" title="è¿›é˜¶ä¹‹è·¯ Blog Atom Feed"><title data-react-helmet="true">Map | è¿›é˜¶ä¹‹è·¯</title><meta data-react-helmet="true" property="og:url" content="https://Goldwood1024.github.io/docs.advanced.way/docs/java/collection/Map"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Map | è¿›é˜¶ä¹‹è·¯"><meta data-react-helmet="true" name="description" content="Map.class"><meta data-react-helmet="true" property="og:description" content="Map.class"><link data-react-helmet="true" rel="shortcut icon" href="/docs.advanced.way/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://Goldwood1024.github.io/docs.advanced.way/docs/java/collection/Map"><link data-react-helmet="true" rel="alternate" href="https://Goldwood1024.github.io/docs.advanced.way/docs/java/collection/Map" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://Goldwood1024.github.io/docs.advanced.way/docs/java/collection/Map" hreflang="x-default"><link rel="stylesheet" href="/docs.advanced.way/assets/css/styles.5e159b62.css">
<link rel="preload" href="/docs.advanced.way/assets/js/runtime~main.aa1c8b94.js" as="script">
<link rel="preload" href="/docs.advanced.way/assets/js/main.8fae9188.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs.advanced.way/"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">è¿›é˜¶ä¹‹è·¯</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs.advanced.way/docs/java/">Java</a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link">ç”Ÿæ€</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs.advanced.way/docs/zoology/spring-family/">Springå®¶æ—</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/zoology/framework/mybatis/">å¸¸ç”¨æ¡†æ¶</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/zoology/distributed/">åˆ†å¸ƒå¼</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/zoology/cloud/docker/base/é•œåƒ/">å®¹å™¨</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/zoology/db/mysql/InnoDB/">æ•°æ®åº“</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/zoology/os/network/tcpip/">è®¡ç®—æœºç³»ç»Ÿ</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link">ç¼–ç å®è·µ</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs.advanced.way/docs/algorithm/algorithm/">ç®—æ³•/æ•°æ®ç»“æ„</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/patterns/">è®¾è®¡æ¨¡å¼</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/architecture/">ç³»ç»Ÿæ¶æ„</a></li><li><a class="dropdown__link" href="/docs.advanced.way/docs/practice/memo/tool/sublime/">å¤‡å¿˜å½•</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs.advanced.way/blog">åšå®¢</a><a href="https://github.com/Goldwood1024/docs.advanced.way.git" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/docs.advanced.way/"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">è¿›é˜¶ä¹‹è·¯</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs.advanced.way/docs/java/">Java</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">ç”Ÿæ€</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/zoology/spring-family/">Springå®¶æ—</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/zoology/framework/mybatis/">å¸¸ç”¨æ¡†æ¶</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/zoology/distributed/">åˆ†å¸ƒå¼</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/zoology/cloud/docker/base/é•œåƒ/">å®¹å™¨</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/zoology/db/mysql/InnoDB/">æ•°æ®åº“</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/zoology/os/network/tcpip/">è®¡ç®—æœºç³»ç»Ÿ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">ç¼–ç å®è·µ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/algorithm/algorithm/">ç®—æ³•/æ•°æ®ç»“æ„</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/patterns/">è®¾è®¡æ¨¡å¼</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/architecture/">ç³»ç»Ÿæ¶æ„</a></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/docs/practice/memo/tool/sublime/">å¤‡å¿˜å½•</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs.advanced.way/blog">åšå®¢</a></li><li class="menu__list-item"><a href="https://github.com/Goldwood1024/docs.advanced.way.git" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/docs.advanced.way/"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/docs.advanced.way/img/logo.svg" alt="è¿›é˜¶ä¹‹è·¯ Logo" class="themedImage_1VuW themedImage--dark_hz6m"><strong>è¿›é˜¶ä¹‹è·¯</strong></a><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">åŸºç¡€</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/">ç®€ä»‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/object">é¢å‘å¯¹è±¡</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/å…³é”®å­—">å…³é”®å­—</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/String">String</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/io">I/O</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/nio">NIO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/Reference">å¯¹è±¡å¼•ç”¨</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/ä»£ç†">ä»£ç†</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/å‡½æ•°å¼æ¥å£">å‡½æ•°å¼æ¥å£</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/åå°„">åå°„</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/base64">Base64ç¼–ç </a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/base/jdk">JDK</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">é›†åˆ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs.advanced.way/docs/java/collection/Collection">Collection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs.advanced.way/docs/java/collection/List">List</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs.advanced.way/docs/java/collection/Map">Map</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">é«˜å¹¶å‘</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/hc/é«˜å¹¶å‘">é«˜å¹¶å‘</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/hc/å¤šçº¿ç¨‹">å¤šçº¿ç¨‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/hc/å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯">å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/hc/å†…å­˜æ¨¡å‹">å†…å­˜æ¨¡å‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/hc/åŸå­ç±»">åŸå­ç±»</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/hc/å¹¶å‘å®¹å™¨">å¹¶å‘å®¹å™¨</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/hc/å¹¶å‘å·¥å…·ç±»">å¹¶å‘å·¥å…·ç±»</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/hc/çº¿ç¨‹æ± ">çº¿ç¨‹æ± </a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/hc/é”">é”</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">JVM</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/å¯¹è±¡åˆ›å»ºè¿‡ç¨‹">å¯¹è±¡åˆ›å»ºè¿‡ç¨‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/å¯¹è±¡å›æ”¶æœºåˆ¶">å¯¹è±¡å›æ”¶æœºåˆ¶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/jvmå‚æ•°">JVMå‚æ•°</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/jvmå†…å­˜æ¨¡å‹">å†…å­˜æ¨¡å‹</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/å†…å­˜ä¼˜åŒ–">å†…å­˜ä¼˜åŒ–</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs.advanced.way/docs/java/jvm/åƒåœ¾æ”¶é›†å™¨">åƒåœ¾æ”¶é›†å™¨</a></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" role="img" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Map</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="mapclass"></a>Map.class<a class="hash-link" href="#mapclass" title="Direct link to heading">#</a></h2><p>HashMapæ˜¯Mapæ¥å£åŸºäºå“ˆå¸Œè¡¨çš„å®ç°ã€‚
è¿™ç§å®ç°æä¾›äº†æ‰€æœ‰å¯é€‰çš„Mapæ“ä½œï¼Œå¹¶å…è®¸keyå’Œvalueä¸ºnullï¼ˆé™¤äº†HashMapæ˜¯unsynchronizedçš„å’Œå…è®¸ä½¿ç”¨nullå¤–ï¼ŒHashMapå’ŒHashTableå¤§è‡´ç›¸åŒã€‚ï¼‰ã€‚</p><p>ä¸ä¿è¯æ˜ å°„çš„é¡ºåºï¼Œç‰¹åˆ«æ˜¯å®ƒä¸ä¿è¯è¯¥é¡ºåºæ’ä¹…ä¸å˜ã€‚</p><p>æ­¤å®ç°å‡è®¾å“ˆå¸Œå‡½æ•°åœ¨æ¡¶å†…é€‚å½“åœ°åˆ†å¸ƒå…ƒç´ ï¼Œä¸ºåŸºæœ¬å®ç°(get å’Œ put)æä¾›äº†ç¨³å®šçš„æ€§èƒ½ã€‚è¿­ä»£ collection è§†å›¾æ‰€éœ€çš„æ—¶é—´ä¸ HashMap å®ä¾‹çš„â€œå®¹é‡â€ï¼ˆæ¡¶çš„æ•°é‡ï¼‰åŠå…¶å¤§å°ï¼ˆé”®-å€¼æ˜ å°„å…³ç³»æ•°ï¼‰æˆæ¯”ä¾‹ã€‚å¦‚æœéå†æ“ä½œå¾ˆé‡è¦ï¼Œå°±ä¸è¦æŠŠåˆå§‹åŒ–å®¹é‡initial capacityè®¾ç½®å¾—å¤ªé«˜ï¼ˆæˆ–å°†åŠ è½½å› å­load factorè®¾ç½®å¾—å¤ªä½ï¼‰ï¼Œå¦åˆ™ä¼šä¸¥é‡é™ä½éå†çš„æ•ˆç‡ã€‚</p><p>HashMapæœ‰ä¸¤ä¸ªå½±å“æ€§èƒ½çš„é‡è¦å‚æ•°ï¼šåˆå§‹åŒ–å®¹é‡ <code>initial capacity</code> ã€åŠ è½½å› å­ <code>load factor</code>ã€‚</p><ul><li>å®¹é‡æ˜¯å“ˆå¸Œè¡¨ä¸­æ¡¶çš„æ•°é‡ï¼Œåˆå§‹å®¹é‡åªæ˜¯å“ˆå¸Œè¡¨åœ¨åˆ›å»ºæ—¶çš„å®¹é‡ã€‚</li><li>åŠ è½½å› å­æ˜¯å“ˆå¸Œè¡¨åœ¨å…¶å®¹é‡è‡ªåŠ¨å¢åŠ ä¹‹å‰å¯ä»¥è¾¾åˆ°å¤šæ»¡çš„ä¸€ç§å°ºåº¦ã€‚</li></ul><p>initial capacity <em> load factor å°±æ˜¯å½“å‰å…è®¸çš„æœ€å¤§å…ƒç´ æ•°ç›®ï¼Œè¶…è¿‡initial capacity</em>load factorä¹‹åï¼ŒHashMapå°±ä¼šè¿›è¡Œrehashedæ“ä½œæ¥è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹åçš„çš„å®¹é‡ä¸ºä¹‹å‰çš„ä¸¤å€ã€‚</p><p>é€šå¸¸ï¼Œé»˜è®¤åŠ è½½å› å­ (0.75) åœ¨æ—¶é—´å’Œç©ºé—´æˆæœ¬ä¸Šå¯»æ±‚ä¸€ç§æŠ˜è¡·ã€‚åŠ è½½å› å­è¿‡é«˜è™½ç„¶å‡å°‘äº†ç©ºé—´å¼€é”€ï¼Œä½†åŒæ—¶ä¹Ÿå¢åŠ äº†æŸ¥è¯¢æˆæœ¬ï¼ˆåœ¨å¤§å¤šæ•° HashMapç±»çš„æ“ä½œä¸­ï¼ŒåŒ…æ‹¬ get å’Œ put æ“ä½œï¼Œéƒ½åæ˜ äº†è¿™ä¸€ç‚¹ï¼‰ã€‚</p><p>åœ¨è®¾ç½®åˆå§‹å®¹é‡æ—¶åº”è¯¥è€ƒè™‘åˆ°æ˜ å°„ä¸­æ‰€éœ€çš„æ¡ç›®æ•°åŠå…¶åŠ è½½å› å­ï¼Œä»¥ä¾¿æœ€å¤§é™åº¦åœ°å‡å°‘rehashæ“ä½œæ¬¡æ•°ã€‚å¦‚æœåˆå§‹å®¹é‡å¤§äºæœ€å¤§æ¡ç›®æ•°é™¤ä»¥åŠ è½½å› å­ï¼Œåˆ™ä¸ä¼šå‘ç”Ÿrehash æ“ä½œã€‚</p><p>å¦‚æœå¾ˆå¤šæ˜ å°„å…³ç³»è¦å­˜å‚¨åœ¨ HashMap å®ä¾‹ä¸­ï¼Œåˆ™ç›¸å¯¹äºæŒ‰éœ€æ‰§è¡Œè‡ªåŠ¨çš„ rehash æ“ä½œä»¥å¢å¤§è¡¨çš„å®¹é‡æ¥è¯´ï¼Œä½¿ç”¨è¶³å¤Ÿå¤§çš„åˆå§‹å®¹é‡åˆ›å»ºå®ƒå°†ä½¿å¾—æ˜ å°„å…³ç³»èƒ½æ›´æœ‰æ•ˆåœ°å­˜å‚¨ã€‚
æ³¨æ„ï¼Œæ­¤å®ç°ä¸æ˜¯åŒæ­¥çš„ã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ªå“ˆå¸Œæ˜ å°„ï¼Œè€Œå…¶ä¸­è‡³å°‘ä¸€ä¸ªçº¿ç¨‹ä»ç»“æ„ä¸Šä¿®æ”¹äº†è¯¥æ˜ å°„ï¼Œåˆ™å®ƒå¿…é¡»ä¿æŒå¤–éƒ¨åŒæ­¥ã€‚ï¼ˆç»“æ„ä¸Šçš„ä¿®æ”¹æ˜¯æŒ‡æ·»åŠ æˆ–åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæ˜ å°„å…³ç³»çš„ä»»ä½•æ“ä½œï¼›ä»…æ”¹å˜ä¸å®ä¾‹å·²ç»åŒ…å«çš„é”®å…³è”çš„å€¼ä¸æ˜¯ç»“æ„ä¸Šçš„ä¿®æ”¹ã€‚ï¼‰è¿™ä¸€èˆ¬é€šè¿‡å¯¹è‡ªç„¶å°è£…è¯¥æ˜ å°„çš„å¯¹è±¡è¿›è¡ŒåŒæ­¥æ“ä½œæ¥å®Œæˆã€‚</p><p>å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„å¯¹è±¡ï¼Œåˆ™åº”è¯¥ä½¿ç”¨ Collections.synchronizedMap æ–¹æ³•æ¥â€œåŒ…è£…â€è¯¥æ˜ å°„ã€‚æœ€å¥½åœ¨åˆ›å»ºæ—¶å®Œæˆè¿™ä¸€æ“ä½œï¼Œä»¥é˜²æ­¢å¯¹æ˜ å°„è¿›è¡Œæ„å¤–çš„éåŒæ­¥è®¿é—®ï¼Œ
å¦‚ä¸‹æ‰€ç¤ºï¼š
Map m = Collections.synchronizedMap(new HashMap(â€¦));</p><p>ç”±æ‰€æœ‰æ­¤ç±»çš„â€œcollection è§†å›¾æ–¹æ³•â€æ‰€è¿”å›çš„è¿­ä»£å™¨éƒ½æ˜¯fail-fast çš„ï¼šåœ¨è¿­ä»£å™¨åˆ›å»ºä¹‹åï¼Œå¦‚æœä»ç»“æ„ä¸Šå¯¹æ˜ å°„è¿›è¡Œä¿®æ”¹ï¼Œé™¤éé€šè¿‡è¿­ä»£å™¨æœ¬èº«çš„removeæ–¹æ³•ï¼Œå…¶ä»–ä»»ä½•æ—¶é—´ä»»ä½•æ–¹å¼çš„ä¿®æ”¹ï¼Œè¿­ä»£å™¨éƒ½å°†æŠ›å‡º ConcurrentModificationExceptionã€‚</p><p>å› æ­¤ï¼Œé¢å¯¹å¹¶å‘çš„ä¿®æ”¹ï¼Œè¿­ä»£å™¨å¾ˆå¿«å°±ä¼šå®Œå…¨å¤±è´¥ï¼Œè€Œä¸å†’åœ¨å°†æ¥ä¸ç¡®å®šçš„æ—¶é—´å‘ç”Ÿä»»æ„ä¸ç¡®å®šè¡Œä¸ºçš„é£é™©ã€‚</p><p>æ³¨æ„ï¼Œè¿­ä»£å™¨çš„å¿«é€Ÿå¤±è´¥è¡Œä¸ºä¸èƒ½å¾—åˆ°ä¿è¯ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå­˜åœ¨éåŒæ­¥çš„å¹¶å‘ä¿®æ”¹æ—¶ï¼Œä¸å¯èƒ½ä½œå‡ºä»»ä½•åšå†³çš„ä¿è¯ã€‚å¿«é€Ÿå¤±è´¥è¿­ä»£å™¨å°½æœ€å¤§åŠªåŠ›æŠ›å‡º ConcurrentModificationExceptionã€‚</p><p>å› æ­¤ï¼Œç¼–å†™ä¾èµ–äºæ­¤å¼‚å¸¸çš„ç¨‹åºçš„åšæ³•æ˜¯é”™è¯¯çš„ï¼Œæ­£ç¡®åšæ³•æ˜¯ï¼šè¿­ä»£å™¨çš„å¿«é€Ÿå¤±è´¥è¡Œä¸ºåº”è¯¥ä»…ç”¨äºæ£€æµ‹bugã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">public interface Map&lt;K, V&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    int size();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    boolean isEmpty();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    boolean containsKey(Object key);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    boolean containsValue(Object value);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    V get(Object key);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    V put(K key, V value);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    V remove(Object key);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void putAll(Map&lt;? extends K, ? extends V&gt; m);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    void clear();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Set&lt;K&gt; keySet();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Collection&lt;V&gt; values();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Set&lt;Map.Entry&lt;K, V&gt;&gt; entrySet();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    boolean equals(Object o);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    int hashCode();</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    interface Entry&lt;K, V&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        K getKey();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        V getValue();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        V setValue(V value);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        boolean equals(Object o);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        int hashCode();</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // æ¯”è¾ƒå™¨</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        public static &lt;K extends Comparable&lt;? super K&gt;, V&gt; Comparator&lt;Map.Entry&lt;K, V&gt;&gt; comparingByKey() {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            return (Comparator&lt;Map.Entry&lt;K, V&gt;&gt; &amp; Serializable)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                (c1, c2) -&gt; c1.getKey().compareTo(c2.getKey());</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        public static &lt;K, V&gt; Comparator&lt;Map.Entry&lt;K, V&gt;&gt; comparingByKey(Comparator&lt;? super K&gt; cmp) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            Objects.requireNonNull(cmp);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            return (Comparator&lt;Map.Entry&lt;K, V&gt;&gt; &amp; Serializable)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                (c1, c2) -&gt; cmp.compare(c1.getKey(), c2.getKey());</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        public static &lt;K, V&gt; Comparator&lt;Map.Entry&lt;K, V&gt;&gt; comparingByValue(Comparator&lt;? super V&gt; cmp) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            Objects.requireNonNull(cmp);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            return (Comparator&lt;Map.Entry&lt;K, V&gt;&gt; &amp; Serializable)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                (c1, c2) -&gt; cmp.compare(c1.getValue(), c2.getValue());</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="åµŒå¥—æ¥å£"></a>åµŒå¥—æ¥å£<a class="hash-link" href="#åµŒå¥—æ¥å£" title="Direct link to heading">#</a></h3><ul><li>å®ƒæ˜¯é€»è¾‘åˆ†ç»„ä»…åœ¨ä¸€ä¸ªåœ°æ–¹ä½¿ç”¨çš„æ¥å£çš„ä¸€ç§æ–¹å¼ã€‚</li><li>å®ƒå¢åŠ äº†å°è£…ã€‚</li><li>åµŒå¥—æ¥å£å¯ä»¥å¯¼è‡´æ›´æ˜“è¯»å’Œå¯ç»´æŠ¤çš„ä»£ç ã€‚</li><li>å†…éƒ¨æ¥å£éƒ½æ˜¯é™æ€çš„</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="hashmapclass"></a>HashMap.class<a class="hash-link" href="#hashmapclass" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="æ¶æ„å›¾"></a>æ¶æ„å›¾<a class="hash-link" href="#æ¶æ„å›¾" title="Direct link to heading">#</a></h3><p><img src="/docs.advanced.way/assets/images/hashmap-b2c22311915bd05b96fa02db891a68f4.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„<a class="hash-link" href="#æ•°æ®ç»“æ„" title="Direct link to heading">#</a></h3><p><img src="/docs.advanced.way/assets/images/88585920190516171536728-de5661ab6859c167cd98df548395b71a.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="æºç "></a>æºç <a class="hash-link" href="#æºç " title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    implements Map&lt;K,V&gt;, Cloneable, Serializable {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // åˆå§‹å®¹å™¨å¤§å° 16</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // å®¹å™¨æœ€å¤§å®¹é‡</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // è´Ÿè½½å› å­</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    static final float DEFAULT_LOAD_FACTOR = 0.75f;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // æ ‘åŒ–é˜€å€¼</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    static final int TREEIFY_THRESHOLD = 8;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // æ¢å¤æˆé“¾å¼ç»“æ„çš„æ¡¶å¤§å°ä¸´ç•Œå€¼</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    static final int UNTREEIFY_THRESHOLD = 6;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // å½“å“ˆå¸Œè¡¨çš„å¤§å°è¶…è¿‡è¿™ä¸ªé˜ˆå€¼ï¼Œæ‰ä¼šæŠŠé“¾å¼ç»“æ„è½¬åŒ–æˆæ ‘å‹ç»“æ„ï¼Œå¦åˆ™ä»…é‡‡å–æ‰©å®¹æ¥å°è¯•å‡å°‘å†²çªã€‚</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // åº”è¯¥è‡³å°‘ 4 * TREEIFY_THRESHOLD æ¥é¿å…æ‰©å®¹å’Œæ ‘å½¢ç»“æ„åŒ–ä¹‹é—´çš„å†²çª</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // åŸå› : æ•°ç»„çš„æ€§èƒ½å¥½äºæ•°ç»“æ„</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    static final int MIN_TREEIFY_CAPACITY = 64;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // å®¹å™¨æ•°ç»„</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    transient Node&lt;K,V&gt;[] table;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    transient Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // å®é™…å­˜å‚¨çš„key-valueé”®å€¼å¯¹çš„ä¸ªæ•°</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    transient int size;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // ä¿®æ”¹æ¬¡æ•°</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    transient int modCount;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // ä¸´ç•Œå€¼ threshold= capacity*loadFactory</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    int threshold;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // åŠ è½½å› å­é»˜è®¤ä¸º0.75, å®é™…å…ƒç´ æ¯” å¤§äºloadFactoråˆ™æ‰©å®¹</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    final float loadFactor;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        final int hash;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        final K key;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        V value;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Node&lt;K,V&gt; next;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Node(int hash, K key, V value, Node&lt;K,V&gt; next) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            this.hash = hash;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            this.key = key;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            this.value = value;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            this.next = next;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        public final K getKey()        { return key; }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        public final V getValue()      { return value; }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        public final String toString() { return key + &quot;=&quot; + value; }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        public final int hashCode() {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            return Objects.hashCode(key) ^ Objects.hashCode(value);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        public final V setValue(V newValue) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            V oldValue = value;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            value = newValue;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            return oldValue;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        public final boolean equals(Object o) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            if (o == this)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                return true;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            if (o instanceof Map.Entry) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                if (Objects.equals(key, e.getKey()) &amp;&amp;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    Objects.equals(value, e.getValue()))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    return true;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            return false;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // æ„é€ å‡½æ•° æŒ‡å®šåˆå§‹å¤§å°å’Œè´Ÿè½½å› å­</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    public HashMap(int initialCapacity, float loadFactor) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if (initialCapacity &lt; 0)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            throw new IllegalArgumentException(&quot;Illegal initial capacity: &quot; +</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                               initialCapacity);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if (initialCapacity &gt; MAXIMUM_CAPACITY)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            initialCapacity = MAXIMUM_CAPACITY;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if (loadFactor &lt;= 0 || Float.isNaN(loadFactor))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            throw new IllegalArgumentException(&quot;Illegal load factor: &quot; +</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                               loadFactor);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        this.loadFactor = loadFactor;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // è®¡ç®—ä¸´ç•Œå€¼</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        this.threshold = tableSizeFor(initialCapacity);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    public HashMap(int initialCapacity) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        this(initialCapacity, DEFAULT_LOAD_FACTOR);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    public HashMap() {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    public HashMap(Map&lt;? extends K, ? extends V&gt; m) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        this.loadFactor = DEFAULT_LOAD_FACTOR;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        putMapEntries(m, false);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    static final int tableSizeFor(int cap) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        int n = -1 &gt;&gt;&gt; Integer.numberOfLeadingZeros(cap - 1);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // æ·»åŠ å€¼</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    public V put(K key, V value) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // è®¡ç®—keyçš„hashå€¼</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return putVal(hash(key), key, value, false, true);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Node&lt;K,V&gt;[] tab;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Node&lt;K,V&gt; p; // hash æŒ‡å‘çš„èŠ‚ç‚¹</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        int n, i; // n æ˜¯å®¹å™¨æ•°ç»„é•¿åº¦</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // å¦‚æœtableä¸ºç©ºæˆ–è€…é•¿åº¦ä¸º0 åˆ™æ‰©å®¹</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if ((tab = table) == null || (n = tab.length) == 0)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            n = (tab = resize()).length;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // tab å½“å‰ä½ç½®ä¸ºç©ºï¼Œç›´æ¥æ’å…¥ï¼ˆå¤šçº¿ç¨‹ä¸‹å®¹æ˜“æ•°æ®è¢«è¦†ç›–ï¼‰</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if ((p = tab[i = (n - 1) &amp; hash]) == null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            tab[i] = newNode(hash, key, value, null);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        else {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            // hash å†²çª</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            Node&lt;K,V&gt; e; K k;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            // key ç›¸åŒ</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                e = p;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            // key ä¸åŒä¸”æ˜¯ä½¿ç”¨çº¢é»‘æ ‘å¤„ç†å†²çª</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            else if (p instanceof TreeNode)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            else {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                // ä½¿ç”¨é“¾è¡¨å¤„ç†å†²çª</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                // éå†é“¾è¡¨</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                for (int binCount = 0; ; ++binCount) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    // é“¾è¡¨çš„å°¾ç«¯ä¹Ÿæ²¡æœ‰æ‰¾åˆ°keyå€¼ç›¸åŒçš„èŠ‚ç‚¹ï¼Œåˆ™ç”Ÿæˆä¸€ä¸ªæ–°çš„Node</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    if ((e = p.next) == null) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        p.next = newNode(hash, key, value, null);</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        // æ˜¯å¦æ ‘åŒ–</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            treeifyBin(tab, hash);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        break;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    // æ‰¾åˆ°ç›¸åŒçš„ key</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        break;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    p = e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            if (e != null) { // existing mapping for key</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                // æ›¿æ¢æ—§çš„å€¼</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                V oldValue = e.value;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                if (!onlyIfAbsent || oldValue == null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    e.value = value;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                afterNodeAccess(e);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                return oldValue;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // ä¿®æ”¹æ¬¡æ•°</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        ++modCount;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // å®é™…å®¹é‡å¤§äºä¸´ç•Œå€¼ æ‰©å®¹</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if (++size &gt; threshold)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            resize();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        afterNodeInsertion(evict);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return null;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // æ‰©å®¹å¹¶å¤åˆ¶æ•°æ®</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    final Node&lt;K,V&gt;[] resize() {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Node&lt;K,V&gt;[] oldTab = table;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        int oldCap = (oldTab == null) ? 0 : oldTab.length;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        int oldThr = threshold;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        int newCap, newThr = 0;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // å®¹å™¨å®é™…å®¹é‡å¤§äº0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if (oldCap &gt; 0) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">             // åˆ¤æ–­å½“å‰Nodeçš„é•¿åº¦ï¼Œå¦‚æœå½“å‰é•¿åº¦è¶…è¿‡ MAXIMUM_CAPACITYï¼ˆæœ€å¤§å®¹é‡å€¼ï¼‰</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            if (oldCap &gt;= MAXIMUM_CAPACITY) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                // æ–°å¢é˜€å€¼ä¸º Integer.MAX_VALUE</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                threshold = Integer.MAX_VALUE;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                return oldTab;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            // å¦‚æœå°äºè¿™ä¸ª MAXIMUM_CAPACITYï¼ˆæœ€å¤§å®¹é‡å€¼ï¼‰ï¼Œå¹¶ä¸”å¤§äº DEFAULT_INITIAL_CAPACITY ï¼ˆé»˜è®¤16ï¼‰</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                // 2å€æ‰©å®¹</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                newThr = oldThr &lt;&lt; 1; // double threshold</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        else if (oldThr &gt; 0) // initial capacity was placed in threshold</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            // æŒ‡å®šæ–°å¢é˜€å€¼</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            newCap = oldThr;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        else {               // zero initial threshold signifies using defaults</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // å¦‚æœæ•°ç»„ä¸ºç©º</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            //ä½¿ç”¨é»˜è®¤çš„åŠ è½½å› å­(0.75)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            newCap = DEFAULT_INITIAL_CAPACITY;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">             // æ–°å¢çš„é˜€å€¼ä¹Ÿå°±ä¸º 16 * 0.75 = 12</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if (newThr == 0) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            // æŒ‰ç…§ç»™å®šçš„åˆå§‹å¤§å°è®¡ç®—æ‰©å®¹åçš„æ–°å¢é˜€å€¼</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            float ft = (float)newCap * loadFactor;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ?</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                      (int)ft : Integer.MAX_VALUE);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // æ‰©å®¹åçš„æ–°å¢é˜€å€¼</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        threshold = newThr;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // æ‰©å®¹åçš„Nodeæ•°ç»„</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap];</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        table = newTab;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">         // å¦‚æœæ•°ç»„ä¸ä¸ºç©ºï¼Œå°†åŸæ•°ç»„ä¸­çš„å…ƒç´ æ”¾å…¥æ‰©å®¹åçš„æ•°ç»„ä¸­</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if (oldTab != null) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            for (int j = 0; j &lt; oldCap; ++j) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                Node&lt;K,V&gt; e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                if ((e = oldTab[j]) != null) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    oldTab[j] = null;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    // å¦‚æœèŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™ç›´æ¥è®¡ç®—åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ï¼Œæ”¾å…¥å³å¯</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    if (e.next == null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        newTab[e.hash &amp; (newCap - 1)] = e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    else if (e instanceof TreeNode)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        // æ‹†åˆ†æ ‘èŠ‚ç‚¹</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    else { // preserve order</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        // å¦‚æœèŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œä¸”ä¸ºå•é“¾è¡¨ï¼Œåˆ™å°†åŸæ•°ç»„ä¸­å•é“¾è¡¨å…ƒç´ è¿›è¡Œæ‹†åˆ†</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        Node&lt;K,V&gt; loHead = null, loTail = null; // ä¿å­˜åœ¨åŸæœ‰ç´¢å¼•çš„é“¾è¡¨</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        Node&lt;K,V&gt; hiHead = null, hiTail = null; // ä¿å­˜åœ¨æ–°ç´¢å¼•çš„é“¾è¡¨</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        Node&lt;K,V&gt; next;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        do {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            next = e.next;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            // å“ˆå¸Œå€¼å’ŒåŸæ•°ç»„é•¿åº¦è¿›è¡Œ&amp;æ“ä½œï¼Œä¸º0åˆ™åœ¨åŸæ•°ç»„çš„ç´¢å¼•ä½ç½®</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            // é0åˆ™åœ¨åŸæ•°ç»„ç´¢å¼•ä½ç½®+åŸæ•°ç»„é•¿åº¦çš„æ–°ä½ç½®</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            if ((e.hash &amp; oldCap) == 0) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                if (loTail == null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                    loHead = e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                else</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                    loTail.next = e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                loTail = e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            else {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                if (hiTail == null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                    hiHead = e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                else</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                    hiTail.next = e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                hiTail = e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        } while ((e = next) != null);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        if (loTail != null) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            loTail.next = null;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            newTab[j] = loHead;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        if (hiTail != null) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            hiTail.next = null;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            newTab[j + oldCap] = hiHead;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return newTab;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // åˆ›å»ºæ–°çš„èŠ‚ç‚¹</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Node&lt;K,V&gt; newNode(int hash, K key, V value, Node&lt;K,V&gt; next) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return new Node&lt;&gt;(hash, key, value, next);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // hashå‡½æ•°</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // (1) å–keyçš„hashCodeå€¼ï¼Œh = key.hashCode()ï¼› </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // (2) é«˜ä½å‚ä¸è¿ç®—ï¼Œh ^ (h &gt;&gt;&gt; 16)ï¼› </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // (3) å–æ¨¡è¿ç®—ï¼Œh &amp; (length-1)ã€‚</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    static final int hash(Object key) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        int h;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // çº¢é»‘æ ‘ç»“æ„å®ç° ç®€ç•¥éƒ¨åˆ†ä»£ç </span></div><div class="token-line" style="color:#393A34"><span class="token plain">    static final class TreeNode&lt;K,V&gt; extends LinkedHashMap.Entry&lt;K,V&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        TreeNode&lt;K,V&gt; parent;  // red-black tree links</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        TreeNode&lt;K,V&gt; left;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        TreeNode&lt;K,V&gt; right;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        TreeNode&lt;K,V&gt; prev;    // needed to unlink next upon deletion</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        boolean red;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        TreeNode(int hash, K key, V val, Node&lt;K,V&gt; next) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            super(hash, key, val, next);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // æŠŠæ”¾å…¥çº¢é»‘æ ‘ä¸­</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        final TreeNode&lt;K,V&gt; putTreeVal(HashMap&lt;K,V&gt; map, Node&lt;K,V&gt;[] tab,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                                       int h, K k, V v) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            Class&lt;?&gt; kc = null;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            boolean searched = false;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            TreeNode&lt;K,V&gt; root = (parent != null) ? root() : this;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            for (TreeNode&lt;K,V&gt; p = root;;) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                int dir, ph; K pk;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                if ((ph = p.hash) &gt; h)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    dir = -1;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                else if (ph &lt; h)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    dir = 1;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                else if ((pk = p.key) == k || (k != null &amp;&amp; k.equals(pk)))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    return p;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                else if ((kc == null &amp;&amp;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                          (kc = comparableClassFor(k)) == null) ||</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                         (dir = compareComparables(kc, k, pk)) == 0) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    if (!searched) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        TreeNode&lt;K,V&gt; q, ch;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        searched = true;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        if (((ch = p.left) != null &amp;&amp;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                             (q = ch.find(h, k, kc)) != null) ||</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            ((ch = p.right) != null &amp;&amp;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                             (q = ch.find(h, k, kc)) != null))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                            return q;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    dir = tieBreakOrder(k, pk);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                TreeNode&lt;K,V&gt; xp = p;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                if ((p = (dir &lt;= 0) ? p.left : p.right) == null) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    Node&lt;K,V&gt; xpn = xp.next;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    TreeNode&lt;K,V&gt; x = map.newTreeNode(h, k, v, xpn);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    if (dir &lt;= 0)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        xp.left = x;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    else</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        xp.right = x;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    xp.next = x;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    x.parent = x.prev = xp;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    if (xpn != null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        ((TreeNode&lt;K,V&gt;)xpn).prev = x;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    moveRootToFront(tab, balanceInsertion(root, x));</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    return null;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        final TreeNode&lt;K,V&gt; getTreeNode(int h, Object k) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            return ((parent != null) ? root() : this).find(h, k, null);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // æŸ¥æ‰¾çº¢é»‘æ ‘</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        final TreeNode&lt;K,V&gt; find(int h, Object k, Class&lt;?&gt; kc) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            TreeNode&lt;K,V&gt; p = this;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            do {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                int ph, dir; K pk;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                TreeNode&lt;K,V&gt; pl = p.left, pr = p.right, q;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                if ((ph = p.hash) &gt; h)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    p = pl;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                else if (ph &lt; h)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    p = pr;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                else if ((pk = p.key) == k || (k != null &amp;&amp; k.equals(pk)))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    return p;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                else if (pl == null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    p = pr;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                else if (pr == null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    p = pl;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                else if ((kc != null ||</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                          (kc = comparableClassFor(k)) != null) &amp;&amp;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                         (dir = compareComparables(kc, k, pk)) != 0)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    p = (dir &lt; 0) ? pl : pr;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                else if ((q = pr.find(h, k, kc)) != null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    return q;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                else</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    p = pl;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            } while (p != null);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            return null;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // è·å–å€¼</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    public V get(Object key) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Node&lt;K,V&gt; e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return (e = getNode(hash(key), key)) == null ? null : e.value;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    final Node&lt;K,V&gt; getNode(int hash, Object key) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Node&lt;K,V&gt;[] tab; </span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Node&lt;K,V&gt; first, e; </span></div><div class="token-line" style="color:#393A34"><span class="token plain">        int n; </span></div><div class="token-line" style="color:#393A34"><span class="token plain">        K k;</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // tableä¸ä¸ºç©ºä¸”é•¿åº¦å¤§äº0ä¸”å€¼å­˜åœ¨</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp; (first = tab[(n - 1) &amp; hash]) != null) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            // å…ˆæ£€æŸ¥å¤´ç»“ç‚¹</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            if (first.hash == hash &amp;&amp;  ((k = first.key) == key || (key != null &amp;&amp; key.equals(k))))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                return first;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            // éå†</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            if ((e = first.next) != null) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                // éå†çº¢é»‘æ•°</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                if (first instanceof TreeNode)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                do {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    // éå†é“¾è¡¨</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                        return e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                } while ((e = e.next) != null);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        return null;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // æ•°åŒ–</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    final void treeifyBin(Node&lt;K,V&gt;[] tab, int hash) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        int n, index; </span></div><div class="token-line" style="color:#393A34"><span class="token plain">        Node&lt;K,V&gt; e;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span></div><div class="token-line" style="color:#393A34"><span class="token plain">        // å®¹å™¨å°äº MIN_TREEIFY_CAPACITY æ‰©å®¹</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        if (tab == null || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            resize();</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        else if ((e = tab[index = (n - 1) &amp; hash]) != null) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            // æ ‘åŒ–æ“ä½œ</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            TreeNode&lt;K,V&gt; hd = null, tl = null;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            do {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                TreeNode&lt;K,V&gt; p = replacementTreeNode(e, null);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                if (tl == null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    hd = p;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                else {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    p.prev = tl;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                    tl.next = p;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                tl = p;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            } while ((e = e.next) != null);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            if ((tab[index] = hd) != null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                hd.treeify(tab);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="hash"></a>hash<a class="hash-link" href="#hash" title="Direct link to heading">#</a></h3><p><code>tab[i = (n - 1) &amp; hash]</code> ç”¨æ¥å®šä½æ¡¶ä½ç½®</p><p><code>(n - 1) &amp; hash</code> ä½è¿ç®—å¾—åˆ°çš„å€¼å°äº (n-1)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="ä¸ºä»€ä¹ˆä¼šhashå†²çª"></a>ä¸ºä»€ä¹ˆä¼šhashå†²çª<a class="hash-link" href="#ä¸ºä»€ä¹ˆä¼šhashå†²çª" title="Direct link to heading">#</a></h3><p>å°±æ˜¯æ ¹æ®keyå³ç»è¿‡ä¸€ä¸ªå‡½æ•°f(key)å¾—åˆ°çš„ç»“æœçš„ä½œä¸ºåœ°å€å»å­˜æ”¾å½“å‰çš„keyï¼Œvalueé”®å€¼å¯¹(è¿™ä¸ªæ˜¯hashmapçš„å­˜å€¼æ–¹å¼)ï¼Œä½†æ˜¯å´å‘ç°ç®—å‡ºæ¥çš„åœ°å€ä¸Šå·²ç»æœ‰æ•°æ®ã€‚</p><p>hashå†²çªçš„å‡ ç§æƒ…å†µ:</p><ul><li>ä¸¤ä¸ªèŠ‚ç‚¹çš„keyå€¼ç›¸åŒï¼ˆhashå€¼ä¸€å®šç›¸åŒï¼‰ï¼Œå¯¼è‡´å†²çª </li><li>ä¸¤ä¸ªèŠ‚ç‚¹çš„keyå€¼ä¸åŒï¼Œç”±äºhashå‡½æ•°çš„å±€é™æ€§å¯¼è‡´hashå€¼ç›¸åŒï¼Œå¯¼è‡´å†²çª </li><li>ä¸¤ä¸ªèŠ‚ç‚¹çš„keyå€¼ä¸åŒï¼Œhashå€¼ä¸åŒï¼Œä½†hashå€¼å¯¹æ•°ç»„é•¿åº¦å–æ¨¡åç›¸åŒï¼Œå¯¼è‡´å†²çª </li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="è§£å†³hashå†²çª"></a>è§£å†³hashå†²çª<a class="hash-link" href="#è§£å†³hashå†²çª" title="Direct link to heading">#</a></h4><ol><li>å¼€æ”¾å¯»å€æ³•--çº¿æ€§æ¢æµ‹</li></ol><p>å½“ä¸€ä¸ªKeyé€šè¿‡hashå‡½æ•°è·å¾—å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡å·²è¢«å ç”¨çš„æ—¶å€™ï¼Œå°±å¯ä»¥å¯»æ‰¾ä¸‹ä¸€ä¸ªç©ºæ¡£ä½ç½®</p><ol start="2"><li>é“¾è¡¨æ³•</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="çº¿ç¨‹ä¸å®‰å…¨çš„è¡¨ç°"></a>çº¿ç¨‹ä¸å®‰å…¨çš„è¡¨ç°<a class="hash-link" href="#çº¿ç¨‹ä¸å®‰å…¨çš„è¡¨ç°" title="Direct link to heading">#</a></h3><p>åœ¨JDK1.8ä¸­ï¼Œåœ¨å¹¶å‘æ‰§è¡Œputæ“ä½œæ—¶ä¼šå‘ç”Ÿæ•°æ®è¦†ç›–çš„æƒ…å†µ</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">if ((p = tab[i = (n - 1) &amp; hash]) == null)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        tab[i] = newNode(hash, key, value, null);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å‘ç”Ÿåœºæ™¯:</p><ol><li>å‡è®¾ä¸¤ä¸ªçº¿ç¨‹Aã€Béƒ½åœ¨è¿›è¡Œputæ“ä½œï¼Œå¹¶ä¸”hashå‡½æ•°è®¡ç®—å‡ºçš„æ’å…¥ä¸‹æ ‡æ˜¯ç›¸åŒçš„</li><li>å½“çº¿ç¨‹Aæ‰§è¡Œå®Œä¸Šé¢ä»£ç åç”±äºæ—¶é—´ç‰‡è€—å°½å¯¼è‡´è¢«æŒ‚èµ·ï¼Œè€Œçº¿ç¨‹Bå¾—åˆ°æ—¶é—´ç‰‡ååœ¨è¯¥ä¸‹æ ‡å¤„æ’å…¥äº†å…ƒç´ ï¼Œå®Œæˆäº†æ­£å¸¸çš„æ’å…¥</li><li>ç„¶åçº¿ç¨‹Aè·å¾—æ—¶é—´ç‰‡ï¼Œç”±äºä¹‹å‰å·²ç»è¿›è¡Œäº†hashç¢°æ’çš„åˆ¤æ–­ï¼Œæ‰€æœ‰æ­¤æ—¶ä¸ä¼šå†è¿›è¡Œåˆ¤æ–­ï¼Œè€Œæ˜¯ç›´æ¥è¿›è¡Œæ’å…¥ï¼Œ</li></ol><p>è¿™å°±å¯¼è‡´äº†çº¿ç¨‹Bæ’å…¥çš„æ•°æ®è¢«çº¿ç¨‹Aè¦†ç›–äº†ï¼Œä»è€Œçº¿ç¨‹ä¸å®‰å…¨</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="linkedhashmapclass"></a>LinkedHashMap.class<a class="hash-link" href="#linkedhashmapclass" title="Direct link to heading">#</a></h2><ul><li>LinkedHashMapæ˜¯ç»§æ‰¿äºHashMapï¼Œæ˜¯åŸºäºHashMapå’ŒåŒå‘é“¾è¡¨æ¥å®ç°çš„ã€‚</li><li>HashMapæ— åºï¼›LinkedHashMapæœ‰åºï¼Œå¯åˆ†ä¸ºæ’å…¥é¡ºåºï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰å’Œè®¿é—®é¡ºåºï¼ˆæœ€è¿‘æœ€å°‘ï¼‰ä¸¤ç§ã€‚<br>å¦‚æœæ˜¯è®¿é—®é¡ºåºï¼Œé‚£putå’Œgetæ“ä½œå·²å­˜åœ¨çš„Entryæ—¶ï¼Œéƒ½ä¼šæŠŠEntryç§»åŠ¨åˆ°åŒå‘é“¾è¡¨çš„è¡¨å°¾(å…¶å®æ˜¯å…ˆåˆ é™¤å†æ’å…¥)ã€‚</li><li>LinkedHashMapå­˜å–æ•°æ®ï¼Œè¿˜æ˜¯è·ŸHashMapä¸€æ ·ä½¿ç”¨çš„Entry[]çš„æ–¹å¼ï¼ŒåŒå‘é“¾è¡¨åªæ˜¯ä¸ºäº†ä¿è¯é¡ºåºã€‚</li><li>LinkedHashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="æ¶æ„å›¾-1"></a>æ¶æ„å›¾<a class="hash-link" href="#æ¶æ„å›¾-1" title="Direct link to heading">#</a></h3><p><img src="/docs.advanced.way/assets/images/LinkedHashMap-8ea2d47f5cfbbe121ff1c963cc4f163b.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="æºç -1"></a>æºç <a class="hash-link" href="#æºç -1" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">public class LinkedHashMap&lt;K,V&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    extends HashMap&lt;K,V&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    implements Map&lt;K,V&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">{</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    transient LinkedHashMap.Entry&lt;K,V&gt; head;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    transient LinkedHashMap.Entry&lt;K,V&gt; tail;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // è¡¨ç¤ºè¿­ä»£é¡ºåºï¼Œtrueè¡¨ç¤ºè®¿é—®é¡ºåºï¼Œfalseè¡¨ç¤ºæ’å…¥é¡ºåº</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    final boolean accessOrder;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="put-æ–¹æ³•"></a>put æ–¹æ³•<a class="hash-link" href="#put-æ–¹æ³•" title="Direct link to heading">#</a></h4><p>LinkedHashMap æ²¡æœ‰é‡å†™putæ–¹æ³•ï¼Œæ‰€ä»¥è¿˜æ˜¯è°ƒç”¨HashMapå¾—åˆ°putæ–¹æ³•</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">// HashMap.class</span></div><div class="token-line" style="color:#393A34"><span class="token plain">public V put(K key, V value) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    return putVal(hash(key), key, value, false, true);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">final V putVal(int hash, K key, V value, boolean onlyIfAbsent,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                boolean evict) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    ...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    afterNodeInsertion(evict);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    return null;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">void afterNodeInsertion(boolean evict) { }</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">// LinkedHashMap.class</span></div><div class="token-line" style="color:#393A34"><span class="token plain">void afterNodeInsertion(boolean evict) { // possibly remove eldest</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    LinkedHashMap.Entry&lt;K,V&gt; first;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    if (evict &amp;&amp; (first = head) != null &amp;&amp; removeEldestEntry(first)) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        K key = first.key;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">        removeNode(hash(key), key, null, false, true);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">protected boolean removeEldestEntry(Map.Entry&lt;K,V&gt; eldest) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    return false;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="å‚è€ƒå†…å®¹"></a>å‚è€ƒå†…å®¹<a class="hash-link" href="#å‚è€ƒå†…å®¹" title="Direct link to heading">#</a></h2><p><a href="https://www.cnblogs.com/myseries/p/10876828.html" target="_blank" rel="noopener noreferrer">Java8 HashMapè¯¦è§£</a></p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/Goldwood1024/docs.advanced.way/tree/master/docs/java/collection/Map.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-07-06T06:05:23.000Z" class="lastUpdatedDate_1WI_">7/6/2021</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs.advanced.way/docs/java/collection/List"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« List</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs.advanced.way/docs/java/hc/é«˜å¹¶å‘"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">é«˜å¹¶å‘ Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#mapclass" class="table-of-contents__link">Map.class</a><ul><li><a href="#åµŒå¥—æ¥å£" class="table-of-contents__link">åµŒå¥—æ¥å£</a></li></ul></li><li><a href="#hashmapclass" class="table-of-contents__link">HashMap.class</a><ul><li><a href="#æ¶æ„å›¾" class="table-of-contents__link">æ¶æ„å›¾</a></li><li><a href="#æ•°æ®ç»“æ„" class="table-of-contents__link">æ•°æ®ç»“æ„</a></li><li><a href="#æºç " class="table-of-contents__link">æºç </a></li><li><a href="#hash" class="table-of-contents__link">hash</a></li><li><a href="#ä¸ºä»€ä¹ˆä¼šhashå†²çª" class="table-of-contents__link">ä¸ºä»€ä¹ˆä¼šhashå†²çª</a></li><li><a href="#çº¿ç¨‹ä¸å®‰å…¨çš„è¡¨ç°" class="table-of-contents__link">çº¿ç¨‹ä¸å®‰å…¨çš„è¡¨ç°</a></li></ul></li><li><a href="#linkedhashmapclass" class="table-of-contents__link">LinkedHashMap.class</a><ul><li><a href="#æ¶æ„å›¾-1" class="table-of-contents__link">æ¶æ„å›¾</a></li><li><a href="#æºç -1" class="table-of-contents__link">æºç </a></li></ul></li><li><a href="#å‚è€ƒå†…å®¹" class="table-of-contents__link">å‚è€ƒå†…å®¹</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 è¿›é˜¶ä¹‹è·¯, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docs.advanced.way/assets/js/runtime~main.aa1c8b94.js"></script>
<script src="/docs.advanced.way/assets/js/main.8fae9188.js"></script>
</body>
</html>